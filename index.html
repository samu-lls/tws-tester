<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Hertz Hunt</title>
<!-- Open Graph / WhatsApp / redes sociais -->
<meta property="og:type"        content="website"/>
<meta property="og:title"       content="Hertz Hunt â€” Teste de Fone"/>
<meta property="og:description" content="20 mÃºsicas. 5 nÃ­veis. Um fone no limite. Descubra atÃ© onde vai o seu headphone."/>
<meta property="og:image"       content="og-preview.png"/>
<meta property="og:image:width" content="1200"/>
<meta property="og:image:height"content="630"/>
<meta name="twitter:card"       content="summary_large_image"/>
<meta name="twitter:title"      content="Hertz Hunt â€” Teste de Fone"/>
<meta name="twitter:description"content="20 mÃºsicas. 5 nÃ­veis. Um fone no limite."/>
<meta name="twitter:image"      content="og-preview.png"/>
<link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg viewBox='0 0 28 28' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='14' cy='14' r='13' fill='rgba(29,185,84,0.12)' stroke='rgba(29,185,84,0.4)' stroke-width='1'/%3E%3Cellipse cx='14' cy='13' rx='5.5' ry='6' fill='rgba(29,185,84,0.25)' stroke='%231DB954' stroke-width='1.2'/%3E%3Ccircle cx='14' cy='12' r='1.2' fill='%231DB954'/%3E%3Ccircle cx='11.8' cy='14' r='.6' fill='%231DB954' opacity='.5'/%3E%3Ccircle cx='16.2' cy='14' r='.6' fill='%231DB954' opacity='.5'/%3E%3Cpath d='M10.5 17.5 Q14 20.5 17.5 17.5' stroke='%231DB954' stroke-width='1.2' fill='none' stroke-linecap='round'/%3E%3Cpath d='M4 10 Q5.5 14 4 18' stroke='rgba(29,185,84,0.4)' stroke-width='1' fill='none' stroke-linecap='round'/%3E%3Cpath d='M24 10 Q22.5 14 24 18' stroke='rgba(29,185,84,0.4)' stroke-width='1' fill='none' stroke-linecap='round'/%3E%3C/svg%3E"/>
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300;1,400&family=DM+Sans:wght@300;400;500;600&display=swap" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
  (function(){
    emailjs.init({ publicKey: 'TwdtGcXMbqNKq0A58' });
  })();
</script>
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RESET & BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after{box-sizing:border-box;margin:0;padding:0}
html{height:100%}
body{font-family:'DM Sans',sans-serif;background:#07070f;color:#f0f0f5;overflow-x:hidden;cursor:none;height:100%}

/* â”€â”€ Custom cursor â”€â”€ */
#cur{position:fixed;width:9px;height:9px;background:#fff;border-radius:50%;pointer-events:none;z-index:99999;transform:translate(-50%,-50%);mix-blend-mode:difference;transition:width .15s,height .15s}
#cur.h{width:5px;height:5px}
#curR{position:fixed;width:34px;height:34px;border:1.5px solid rgba(255,255,255,.4);border-radius:50%;pointer-events:none;z-index:99998;transform:translate(-50%,-50%);transition:width .2s,height .2s,opacity .2s}
#curR.h{width:48px;height:48px;opacity:.35}

/* â”€â”€ Noise overlay â”€â”€ */
.noise::after{content:'';position:absolute;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");pointer-events:none;z-index:2;opacity:.7}

/* â”€â”€ Toast â”€â”€ */
#toast{position:fixed;bottom:28px;left:50%;transform:translateX(-50%);z-index:10000;background:rgba(15,15,25,.95);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:12px 20px;font-size:.73rem;color:rgba(255,255,255,.65);display:flex;align-items:center;gap:10px;backdrop-filter:blur(20px);opacity:0;transition:opacity .3s;pointer-events:none;white-space:nowrap}
#toast.show{opacity:1}
#toast .t-icon{font-size:1rem}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HEADER / NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#header{
  position:fixed;top:0;left:0;right:0;z-index:9000;
  display:flex;align-items:center;justify-content:space-between;
  padding:0 40px;height:60px;
  background:rgba(7,7,15,.55);
  border-bottom:1px solid rgba(255,255,255,.07);
  backdrop-filter:blur(24px) saturate(1.4);
  -webkit-backdrop-filter:blur(24px) saturate(1.4);
}
.nav-brand{display:flex;align-items:center;gap:10px;cursor:pointer;transition:opacity .2s;text-decoration:none}
.nav-brand:hover{opacity:.75}
.nav-brand-icon{width:28px;height:28px;flex-shrink:0}
.nav-brand-text{display:flex;flex-direction:column;line-height:1}
.nav-brand-name{font-size:.72rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:#fff}
.nav-brand-sub{font-size:.48rem;font-weight:500;letter-spacing:3px;text-transform:uppercase;color:rgba(255,255,255,.3);margin-top:2px}
.nav-links{display:flex;align-items:center;gap:4px}
.nav-link{
  font-size:.65rem;font-weight:600;letter-spacing:2.5px;text-transform:uppercase;
  color:rgba(255,255,255,.35);padding:8px 16px;border-radius:8px;
  cursor:pointer;transition:all .2s;position:relative;border:1px solid transparent;
}
.nav-link:hover,.nav-link.active{color:#fff;background:rgba(255,255,255,.07);border-color:rgba(255,255,255,.1)}
.nav-link.active{color:#fff}
.nav-link::after{content:'';position:absolute;bottom:-1px;left:50%;transform:translateX(-50%);width:0;height:1px;background:#1DB954;transition:width .25s}
.nav-link.active::after{width:60%}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PAGES â€” wrapper-based isolation
   #page-wrapper fica abaixo do header fixo.
   Cada .page fica oculta atÃ© ser ativada;
   quando ativa, ocupa 100% e rola por conta.
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
html,body{height:100%;overflow:hidden}

#page-wrapper{
  position:fixed;
  top:60px;left:0;right:0;bottom:0;
  overflow:hidden;
}

.page{display:none}
.page.active{
  display:block;
  width:100%;height:100%;
  overflow-y:auto;
  overflow-x:hidden;
  -webkit-overflow-scrolling:touch;
}

/* Experience usa scroll-snap interno â€” nÃ£o rola pelo .page */
#page-experience.active{overflow:hidden}

/* Apoiase â€” scroll vertical, conteÃºdo centralizado horizontalmente */
#page-apoiase.active{
  display:block;
  overflow-y:auto;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HOME PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#page-home{}

/* Hero */
.home-hero{
  position:relative;min-height:100vh;display:flex;flex-direction:column;
  justify-content:center;padding:0 80px;overflow:hidden;
}
.home-hero-bg{
  position:absolute;inset:0;
  background:radial-gradient(ellipse 70% 65% at 10% 90%,rgba(29,185,84,.11) 0,transparent 55%),
             radial-gradient(ellipse 60% 55% at 90% 10%,rgba(100,60,200,.08) 0,transparent 55%);
  animation:breathe 10s ease-in-out infinite alternate;
}
@keyframes breathe{from{opacity:.6}to{opacity:1}}
.home-hero-inner{position:relative;z-index:3;max-width:760px}
.home-eyebrow{font-size:.62rem;font-weight:700;letter-spacing:4px;text-transform:uppercase;color:#1DB954;margin-bottom:24px;display:flex;align-items:center;gap:10px}
.home-eyebrow::before{content:'';width:28px;height:1px;background:#1DB954}
.home-h1{font-family:'Cormorant Garamond',serif;font-size:clamp(3.8rem,7.5vw,8rem);line-height:.9;font-weight:300;letter-spacing:-4px;color:#fff;margin-bottom:28px}
.home-h1 em{font-style:italic;color:rgba(255,255,255,.32)}
.home-sub{font-size:1rem;line-height:1.9;color:rgba(255,255,255,.38);font-weight:300;max-width:480px;margin-bottom:56px}

/* Nav cards row */
.home-nav-cards{display:flex;gap:12px;flex-wrap:wrap}
.hnc{
  display:flex;flex-direction:column;gap:6px;
  padding:18px 22px;border-radius:16px;
  border:1px solid rgba(255,255,255,.08);
  background:rgba(255,255,255,.03);
  cursor:pointer;transition:all .25s;min-width:150px;
  backdrop-filter:blur(12px);position:relative;overflow:hidden;
}
.hnc::before{content:'';position:absolute;inset:0;background:var(--hc,#1DB954);opacity:0;transition:opacity .25s;border-radius:16px}
.hnc:hover{border-color:var(--hc,#1DB954);transform:translateY(-3px);box-shadow:0 12px 32px rgba(0,0,0,.5)}
.hnc:hover::before{opacity:.08}
.hnc-arrow{font-size:.65rem;color:var(--hc,#1DB954);position:relative;z-index:1;opacity:0;transition:opacity .2s;transform:translateY(2px)}
.hnc:hover .hnc-arrow{opacity:1;transform:translateY(0)}
.hnc-label{font-size:.58rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--hc,#1DB954);position:relative;z-index:1}
.hnc-title{font-family:'Cormorant Garamond',serif;font-size:1.4rem;font-weight:300;color:#fff;position:relative;z-index:1}
.hnc-desc{font-size:.7rem;color:rgba(255,255,255,.35);line-height:1.6;position:relative;z-index:1}

/* Home scroll indicator */
.home-scroll{position:absolute;bottom:36px;left:80px;display:flex;align-items:center;gap:10px;font-size:.6rem;letter-spacing:2.5px;text-transform:uppercase;color:rgba(255,255,255,.22);z-index:3}
.home-scroll-dot{width:5px;height:5px;border-radius:50%;background:#1DB954;animation:blink 1.5s ease-in-out infinite}
@keyframes blink{0%,100%{opacity:.25}50%{opacity:1}}

/* Challenges section in Home */
.home-challenges{padding:80px 80px 100px}
.home-challenges-header{margin-bottom:48px}
.hch-eyebrow{font-size:.6rem;font-weight:700;letter-spacing:4px;text-transform:uppercase;color:#1DB954;margin-bottom:16px;display:flex;align-items:center;gap:10px}
.hch-eyebrow::before{content:'';width:24px;height:1px;background:#1DB954}
.hch-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.2rem,4vw,3.5rem);font-weight:300;letter-spacing:-2px;color:#fff}
.hch-title em{font-style:italic;color:rgba(255,255,255,.32)}

/* Level rows */
.lvl-section{margin-bottom:40px}
.lvl-header{display:flex;align-items:center;gap:14px;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid rgba(255,255,255,.05)}
.lvl-badge{display:flex;align-items:center;gap:8px}
.lvl-emoji{font-size:.9rem}
.lvl-name-txt{font-size:.58rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.28)}
.lvl-pips-row{display:flex;gap:3px}
.lvl-pip-dot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.1)}

/* Challenge cards grid */
.challenge-cards{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
.ccard{
  padding:18px 20px;border-radius:14px;
  border:1px solid rgba(255,255,255,.07);
  background:rgba(255,255,255,.025);
  cursor:pointer;transition:all .22s;
  backdrop-filter:blur(8px);position:relative;overflow:hidden;
}
.ccard::before{content:'';position:absolute;inset:0;background:var(--cc,#1DB954);opacity:0;transition:opacity .22s;border-radius:14px}
.ccard:hover{border-color:var(--cc,#1DB954);transform:translateY(-2px);box-shadow:0 10px 28px rgba(0,0,0,.45)}
.ccard:hover::before{opacity:.07}
.ccard-genre{font-size:.55rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--cc,#1DB954);margin-bottom:8px;position:relative;z-index:1}
.ccard-challenge{font-size:.82rem;font-weight:500;color:#fff;margin-bottom:10px;line-height:1.45;position:relative;z-index:1}
.ccard-track{font-size:.72rem;color:rgba(255,255,255,.38);position:relative;z-index:1}
.ccard-track strong{color:rgba(255,255,255,.6);font-weight:500}
.ccard-arrow{position:absolute;bottom:16px;right:16px;width:24px;height:24px;border-radius:50%;border:1px solid var(--cc,#1DB954);display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity .2s;z-index:1}
.ccard:hover .ccard-arrow{opacity:1}
.ccard-arrow svg{width:10px;height:10px;stroke:var(--cc,#1DB954)}

/* â”€â”€ POPUP / MODAL â”€â”€ */
#modal-overlay{
  position:fixed;inset:0;z-index:8000;
  background:rgba(3,3,10,.75);backdrop-filter:blur(16px);
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity .3s;
  padding:20px;
}
#modal-overlay.open{opacity:1;pointer-events:all}
.modal-box{
  position:relative;width:100%;max-width:640px;max-height:90vh;overflow-y:auto;
  background:rgba(14,14,24,.96);border:1px solid rgba(255,255,255,.1);
  border-radius:24px;padding:40px;
  box-shadow:0 32px 80px rgba(0,0,0,.8);
  transform:translateY(16px) scale(.97);transition:transform .3s;
}
#modal-overlay.open .modal-box{transform:translateY(0) scale(1)}
.modal-close{
  position:absolute;top:18px;right:18px;
  width:32px;height:32px;border-radius:50%;
  border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);
  color:rgba(255,255,255,.5);font-size:14px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;transition:all .2s;
}
.modal-close:hover{background:rgba(255,255,255,.12);color:#fff}
.modal-genre-badge{display:inline-flex;align-items:center;font-size:.55rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 12px;border-radius:999px;border:1px solid var(--tc,#1DB954);color:var(--tc,#1DB954);background:color-mix(in srgb,var(--tc,#1DB954) 8%,transparent);margin-bottom:16px}
.modal-challenge{font-size:.65rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--tc,#1DB954);margin-bottom:12px;display:flex;align-items:center;gap:8px}
.modal-challenge::before{content:'';width:18px;height:1px;background:var(--tc,#1DB954)}
.modal-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2rem,4vw,3rem);font-weight:300;letter-spacing:-2px;color:#fff;margin-bottom:6px;line-height:.95}
.modal-artist{font-size:.85rem;color:rgba(255,255,255,.38);margin-bottom:24px;font-weight:300}
.modal-desc{font-size:.82rem;line-height:1.85;color:rgba(255,255,255,.5);border-left:2px solid var(--tc,#1DB954);padding-left:14px;margin-bottom:28px;font-weight:300}
.modal-diff{display:flex;align-items:center;gap:10px;margin-bottom:28px}
.modal-diff-label{font-size:.58rem;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.25)}
.modal-diff-pips{display:flex;gap:4px}
.modal-diff-pip{width:7px;height:7px;border-radius:50%;background:rgba(255,255,255,.1)}
.modal-diff-pip.on{background:var(--tc,#1DB954);box-shadow:0 0 6px var(--tc,#1DB954)}

/* Modal player */
.modal-player{display:flex;flex-direction:column;align-items:center;gap:18px;padding:24px;border-radius:16px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.06)}
.modal-vinyl{width:120px;height:120px;border-radius:50%;position:relative;
  background:conic-gradient(#191919 0deg,#0f0f0f 12deg,#191919 24deg,#0f0f0f 36deg,#191919 48deg,#0f0f0f 60deg,#191919 72deg,#0f0f0f 84deg,#191919 96deg,#0f0f0f 108deg,#191919 120deg,#0f0f0f 132deg,#191919 144deg,#0f0f0f 156deg,#191919 168deg,#0f0f0f 180deg,#191919 192deg,#0f0f0f 204deg,#191919 216deg,#0f0f0f 228deg,#191919 240deg,#0f0f0f 252deg,#191919 264deg,#0f0f0f 276deg,#191919 288deg,#0f0f0f 300deg,#191919 312deg,#0f0f0f 324deg,#191919 336deg,#0f0f0f 348deg);
  box-shadow:0 0 0 1.5px rgba(255,255,255,.05),0 16px 40px rgba(0,0,0,.7);
  animation:spin 8s linear infinite paused;flex-shrink:0}
.modal-vinyl::before{content:'';position:absolute;inset:28%;border-radius:50%;background:var(--tc,#1DB954);box-shadow:0 0 16px var(--tc,#1DB954);opacity:.9}
.modal-vinyl::after{content:'';position:absolute;inset:46%;border-radius:50%;background:#0e0e18;box-shadow:0 0 0 1.5px rgba(255,255,255,.08)}
.modal-vinyl.playing{animation-play-state:running}
@keyframes spin{from{transform:rotate(0)}to{transform:rotate(360deg)}}
.modal-waveform{display:flex;align-items:flex-end;gap:3px;height:28px}
.modal-wb{width:3px;border-radius:3px;background:var(--tc,#1DB954);opacity:.6;animation:wa .9s ease-in-out infinite alternate paused}
.modal-waveform.playing .modal-wb{animation-play-state:running}
@keyframes wa{from{transform:scaleY(.15)}to{transform:scaleY(1)}}
.modal-controls{display:flex;align-items:center;gap:12px}
.modal-play-btn{width:52px;height:52px;border-radius:50%;background:rgba(255,255,255,.08);border:1.5px solid rgba(255,255,255,.18);color:#fff;font-size:15px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;backdrop-filter:blur(10px)}
.modal-play-btn:hover{background:rgba(255,255,255,.16);transform:scale(1.06)}
.modal-play-btn.playing{background:var(--tc,#1DB954);border-color:var(--tc,#1DB954);color:#000}
.modal-play-btn.loading{opacity:.6;cursor:wait}
.modal-sp-btn{display:inline-flex;align-items:center;gap:7px;padding:9px 16px;border-radius:999px;background:rgba(29,185,84,.12);border:1px solid rgba(29,185,84,.28);color:#1DB954;font-size:.68rem;font-weight:600;letter-spacing:.8px;text-decoration:none;transition:all .2s;text-transform:uppercase}
.modal-sp-btn:hover{background:rgba(29,185,84,.22);transform:translateY(-2px)}
.modal-prog{width:100%;display:flex;flex-direction:column;gap:5px}
.modal-track-bar{width:100%;height:2px;background:rgba(255,255,255,.1);border-radius:2px;cursor:pointer}
.modal-track-fill{height:100%;background:var(--tc,#1DB954);border-radius:2px;width:0%}
.modal-times{display:flex;justify-content:space-between;font-size:.58rem;color:rgba(255,255,255,.28)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EXPERIENCE PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#page-experience{overflow:hidden}
.exp-page{overflow-y:auto;overflow-x:hidden}

/* Snap scroll inside experience */
.exp-scroll-container{
  height:100%;overflow-y:scroll;overflow-x:hidden;
  scroll-snap-type:y mandatory;scroll-behavior:auto;
}
.exp-section{
  width:100%;height:100vh;scroll-snap-align:start;
  position:relative;overflow:hidden;display:flex;flex-direction:column;
}
.exp-section::after{content:'';position:absolute;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.75' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.04'/%3E%3C/svg%3E");pointer-events:none;z-index:2;opacity:.7}

/* Exp screen 1 â€” fone */
#exp-intro{background:#07070f;justify-content:center;align-items:center}
.exp-intro-bg{position:absolute;inset:0;background:radial-gradient(ellipse 65% 65% at 50% 50%,rgba(29,185,84,.08) 0,transparent 60%)}
.exp-intro-inner{position:relative;z-index:3;display:flex;flex-direction:column;align-items:center;text-align:center;gap:24px;max-width:520px;padding:0 32px}
.exp-headphone-icon{font-size:4rem;animation:float 3s ease-in-out infinite}
@keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-10px)}}
.exp-intro-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.4rem,5vw,4rem);font-weight:300;letter-spacing:-2px;color:#fff;line-height:.95}
.exp-intro-title em{font-style:italic;color:rgba(255,255,255,.35)}
.exp-intro-sub{font-size:.85rem;color:rgba(255,255,255,.38);line-height:1.8;font-weight:300}
.exp-play-btn{
  width:64px;height:64px;border-radius:50%;
  background:rgba(29,185,84,.15);border:1.5px solid rgba(29,185,84,.4);
  color:#1DB954;font-size:20px;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  transition:all .25s;margin-top:8px;
  box-shadow:0 0 32px rgba(29,185,84,.15);
}
.exp-play-btn:hover{background:rgba(29,185,84,.28);transform:scale(1.08);box-shadow:0 0 48px rgba(29,185,84,.25)}

/* Exp screen 2 â€” intro text */
#exp-about{background:#07070f;justify-content:center;align-items:center}
.exp-about-bg{position:absolute;inset:0;background:radial-gradient(ellipse 55% 55% at 20% 80%,rgba(29,185,84,.1) 0,transparent 55%),radial-gradient(ellipse 50% 50% at 80% 20%,rgba(100,60,200,.07) 0,transparent 55%)}
.exp-about-inner{position:relative;z-index:3;max-width:640px;padding:0 56px}
.exp-about-eyebrow{font-size:.6rem;font-weight:700;letter-spacing:4px;text-transform:uppercase;color:#1DB954;margin-bottom:20px;display:flex;align-items:center;gap:10px}
.exp-about-eyebrow::before{content:'';width:24px;height:1px;background:#1DB954}
.exp-about-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.6rem,5vw,4.5rem);font-weight:300;letter-spacing:-3px;color:#fff;line-height:.93;margin-bottom:24px}
.exp-about-title em{font-style:italic;color:rgba(255,255,255,.32)}
.exp-about-body{font-size:.9rem;line-height:2;color:rgba(255,255,255,.42);font-weight:300;border-left:2px solid rgba(29,185,84,.4);padding-left:18px}
.exp-about-cta{margin-top:36px;display:inline-flex;align-items:center;gap:8px;font-size:.65rem;font-weight:700;letter-spacing:2.5px;text-transform:uppercase;color:rgba(255,255,255,.3);animation:fc 2.2s ease-in-out infinite}
@keyframes fc{0%,100%{transform:translateY(0)}50%{transform:translateY(4px)}}
.exp-about-arrow{width:16px;height:16px;border-right:1px solid currentColor;border-bottom:1px solid currentColor;transform:rotate(45deg);margin-top:-4px}

/* Exp screen 3 â€” desafios grid */
#exp-challenges{background:#07070f;justify-content:center;align-items:center}
.exp-ch-bg{position:absolute;inset:0;background:radial-gradient(ellipse 70% 60% at 85% 15%,rgba(29,185,84,.09) 0,transparent 55%),radial-gradient(ellipse 55% 55% at 15% 85%,rgba(100,60,200,.07) 0,transparent 55%)}
.exp-ch-inner{position:relative;z-index:3;width:100%;max-width:1100px;padding:0 56px}
.exp-ch-title{font-family:'Cormorant Garamond',serif;font-size:clamp(1.6rem,3vw,2.6rem);font-weight:300;letter-spacing:-2px;color:#fff;margin-bottom:32px;text-align:center}
.exp-ch-title em{font-style:italic;color:rgba(255,255,255,.32)}
/* 5 colunas (uma por nÃ­vel) */
.exp-ch-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:10px;align-items:start}
.exp-ch-col{}
.exp-ch-col-header{display:flex;flex-direction:column;align-items:center;gap:6px;margin-bottom:12px;padding-bottom:10px;border-bottom:1px solid rgba(255,255,255,.06)}
.exp-ch-lv-emoji{font-size:1rem}
.exp-ch-lv-name{font-size:.5rem;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;color:rgba(255,255,255,.25)}
.exp-ch-pips{display:flex;gap:2px}
.exp-ch-pip{width:4px;height:4px;border-radius:50%;background:rgba(255,255,255,.1)}
.exp-ch-item{
  padding:10px 12px;border-radius:10px;margin-bottom:7px;
  border:1px solid rgba(255,255,255,.06);background:rgba(255,255,255,.02);
  cursor:pointer;transition:all .2s;font-size:.7rem;color:rgba(255,255,255,.55);
  line-height:1.4;
}
.exp-ch-item:hover{border-color:var(--cc,#1DB954);color:#fff;background:rgba(255,255,255,.04);transform:scale(1.02)}

/* Exp track sections */
.exp-ts{justify-content:center;align-items:center}
.t-bg{position:absolute;inset:-60px;background-size:cover;background-position:center;filter:blur(90px) saturate(1.6) brightness(.28);transform:scale(1.15)}
.t-ov{position:absolute;inset:0;background:radial-gradient(ellipse 75% 75% at 50% 50%,rgba(7,7,15,0) 25%,rgba(7,7,15,.9) 75%),linear-gradient(to bottom,rgba(7,7,15,.7) 0,transparent 25%,transparent 75%,rgba(7,7,15,.85) 100%)}
.t-prog{position:absolute;top:0;left:0;height:2px;background:linear-gradient(90deg,var(--tc,#1DB954),color-mix(in srgb,var(--tc,#1DB954) 60%,#fff));width:0%;z-index:10;box-shadow:0 0 10px var(--tc,#1DB954);transition:width .25s linear}

/* Top bar: counter left, right column has genre + diff + next stacked */
.t-nav{position:absolute;top:22px;left:0;right:0;display:flex;justify-content:space-between;align-items:flex-start;padding:0 44px;z-index:10}
.t-ctr{font-size:.62rem;letter-spacing:3px;text-transform:uppercase;color:rgba(255,255,255,.28)}
.t-nav-right{display:flex;flex-direction:column;align-items:flex-end;gap:8px}
.t-genre{font-size:.6rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:4px 13px;border-radius:999px;border:1px solid var(--tc,#1DB954);color:var(--tc,#1DB954);background:color-mix(in srgb,var(--tc,#1DB954) 8%,transparent);backdrop-filter:blur(8px)}
.t-diff-inline{display:flex;align-items:center;gap:7px;font-size:.58rem;letter-spacing:1.5px;text-transform:uppercase;color:rgba(255,255,255,.25)}
.t-diff-pips{display:flex;gap:3px}
.t-diff-pip{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.1)}
.t-diff-pip.on{background:var(--tc,#1DB954);box-shadow:0 0 4px var(--tc,#1DB954)}
.t-next-inline{font-size:.55rem;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.2);display:flex;align-items:center;gap:5px;animation:fc 2.2s ease-in-out infinite}
.t-next-arrow{width:14px;height:14px;border-right:1px solid rgba(255,255,255,.2);border-bottom:1px solid rgba(255,255,255,.2);transform:rotate(45deg);margin-top:-3px}

.t-content{position:relative;z-index:5;display:grid;grid-template-columns:1fr 1fr;gap:72px;align-items:center;padding:80px 56px 40px;width:100%;max-width:1160px}
.challenge-label{font-size:.62rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:var(--tc,#1DB954);margin-bottom:12px;display:flex;align-items:center;gap:8px}
.challenge-label::before{content:'';width:18px;height:1px;background:var(--tc,#1DB954)}
.t-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.6rem,4.5vw,4.8rem);line-height:.93;font-weight:300;letter-spacing:-2px;color:#fff;margin-bottom:8px}
.t-artist{font-size:.88rem;color:rgba(255,255,255,.38);font-weight:300;margin-bottom:26px;letter-spacing:.3px}
.t-desc{font-size:.82rem;line-height:1.85;color:rgba(255,255,255,.45);max-width:400px;font-weight:300;border-left:2px solid var(--tc,#1DB954);padding-left:14px}
.t-player{display:flex;flex-direction:column;align-items:center;gap:22px}
.vinyl{width:190px;height:190px;border-radius:50%;position:relative;
  background:conic-gradient(#191919 0deg,#0f0f0f 12deg,#191919 24deg,#0f0f0f 36deg,#191919 48deg,#0f0f0f 60deg,#191919 72deg,#0f0f0f 84deg,#191919 96deg,#0f0f0f 108deg,#191919 120deg,#0f0f0f 132deg,#191919 144deg,#0f0f0f 156deg,#191919 168deg,#0f0f0f 180deg,#191919 192deg,#0f0f0f 204deg,#191919 216deg,#0f0f0f 228deg,#191919 240deg,#0f0f0f 252deg,#191919 264deg,#0f0f0f 276deg,#191919 288deg,#0f0f0f 300deg,#191919 312deg,#0f0f0f 324deg,#191919 336deg,#0f0f0f 348deg);
  box-shadow:0 0 0 1.5px rgba(255,255,255,.05),0 24px 60px rgba(0,0,0,.8);
  animation:spin 8s linear infinite paused}
.vinyl::before{content:'';position:absolute;inset:28%;border-radius:50%;background:var(--tc,#1DB954);box-shadow:0 0 20px var(--tc,#1DB954);opacity:.9}
.vinyl::after{content:'';position:absolute;inset:46%;border-radius:50%;background:#07070f;box-shadow:0 0 0 1.5px rgba(255,255,255,.08)}
.vinyl.playing{animation-play-state:running}
.waveform{display:flex;align-items:flex-end;gap:3px;height:38px}
.wb{width:3px;border-radius:3px;background:var(--tc,#1DB954);opacity:.6;animation:wa .9s ease-in-out infinite alternate paused}
.waveform.playing .wb{animation-play-state:running}
.controls-row{display:flex;align-items:center;gap:14px}
.play-btn{width:58px;height:58px;border-radius:50%;background:rgba(255,255,255,.08);border:1.5px solid rgba(255,255,255,.18);color:#fff;font-size:17px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;backdrop-filter:blur(10px)}
.play-btn:hover{background:rgba(255,255,255,.18);transform:scale(1.06)}
.play-btn.playing{background:var(--tc,#1DB954);border-color:var(--tc,#1DB954);color:#000}
.play-btn.loading{opacity:.6;cursor:wait}
.sp-btn{display:inline-flex;align-items:center;gap:7px;padding:9px 18px;border-radius:999px;background:rgba(29,185,84,.12);border:1px solid rgba(29,185,84,.28);color:#1DB954;font-size:.7rem;font-weight:600;letter-spacing:.8px;text-decoration:none;transition:all .2s;text-transform:uppercase}
.sp-btn:hover{background:rgba(29,185,84,.22);transform:translateY(-2px)}
.sp-ico{width:15px;height:15px;flex-shrink:0}
.a-prog{width:100%;display:flex;flex-direction:column;gap:5px}
.a-track{width:100%;height:2px;background:rgba(255,255,255,.1);border-radius:2px;cursor:pointer;position:relative}
.a-fill{height:100%;background:var(--tc,#1DB954);border-radius:2px;width:0%}
.a-times{display:flex;justify-content:space-between;font-size:.6rem;color:rgba(255,255,255,.28);letter-spacing:.4px}
/* Exp side dots */
#exp-sdots{position:fixed;right:22px;top:50%;transform:translateY(-50%);z-index:8500;display:flex;flex-direction:column;gap:8px;display:none}
#exp-sdots.visible{display:flex}
.exp-sdot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.14);cursor:pointer;transition:all .28s}
.exp-sdot.active{background:#fff;transform:scale(1.5);box-shadow:0 0 7px rgba(255,255,255,.35)}
.exp-sdot:hover{background:rgba(255,255,255,.45)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYLIST PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#page-playlist{flex-direction:column}
#page-playlist.active{display:flex}
.pl-page-inner{max-width:780px;margin:0 auto;width:100%;padding:60px 40px 100px}
.pl-header{margin-bottom:48px}
.pl-eyebrow{font-size:.6rem;font-weight:700;letter-spacing:4px;text-transform:uppercase;color:#1DB954;margin-bottom:16px;display:flex;align-items:center;gap:10px}
.pl-eyebrow::before{content:'';width:24px;height:1px;background:#1DB954}
.pl-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.4rem,5vw,4rem);font-weight:300;letter-spacing:-3px;color:#fff;margin-bottom:14px;line-height:.93}
.pl-title em{font-style:italic;color:rgba(255,255,255,.32)}
.pl-meta{display:flex;align-items:center;gap:16px;flex-wrap:wrap}
.pl-count-badge{font-size:.65rem;color:rgba(255,255,255,.28);letter-spacing:1px}
.pl-sp-link{display:inline-flex;align-items:center;gap:8px;padding:10px 20px;border-radius:999px;background:rgba(29,185,84,.12);border:1px solid rgba(29,185,84,.3);color:#1DB954;font-size:.7rem;font-weight:600;letter-spacing:.8px;text-decoration:none;transition:all .22s;text-transform:uppercase}
.pl-sp-link:hover{background:rgba(29,185,84,.22);transform:translateY(-2px);box-shadow:0 8px 24px rgba(29,185,84,.15)}

/* Playlist controls bar */
.pl-controls{display:flex;align-items:center;gap:12px;margin-bottom:24px;padding:16px 20px;border-radius:16px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.07)}
.pl-ctrl-btn{width:40px;height:40px;border-radius:50%;background:rgba(255,255,255,.07);border:1px solid rgba(255,255,255,.12);color:rgba(255,255,255,.6);font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s;flex-shrink:0}
.pl-ctrl-btn:hover{background:rgba(255,255,255,.14);color:#fff}
.pl-ctrl-btn.active-play{background:#1DB954;border-color:#1DB954;color:#000}
.pl-now-playing{flex:1;min-width:0}
.pl-np-track{font-size:.8rem;font-weight:500;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pl-np-artist{font-size:.68rem;color:rgba(255,255,255,.35)}
.pl-progress-wrap{display:flex;flex-direction:column;gap:4px;flex:1;min-width:0}
.pl-prog-bar{width:100%;height:2px;background:rgba(255,255,255,.1);border-radius:2px;cursor:pointer}
.pl-prog-fill{height:100%;background:#1DB954;border-radius:2px;width:0%;transition:width .1s linear}
.pl-times{display:flex;justify-content:space-between;font-size:.55rem;color:rgba(255,255,255,.25)}

/* Track list */
.pl-track-list{display:flex;flex-direction:column;gap:2px}
.pl-track-row{
  display:flex;align-items:center;gap:14px;
  padding:11px 16px;border-radius:10px;
  cursor:pointer;transition:all .18s;
  border:1px solid transparent;
}
.pl-track-row:hover{background:rgba(255,255,255,.04);border-color:rgba(255,255,255,.06)}
.pl-track-row.active{background:rgba(29,185,84,.07);border-color:rgba(29,185,84,.18)}
.pl-tr-num{font-size:.6rem;color:rgba(255,255,255,.2);font-weight:600;width:22px;text-align:right;flex-shrink:0}
.pl-track-row.active .pl-tr-num{color:#1DB954}
.pl-tr-icon{width:22px;text-align:center;flex-shrink:0;font-size:12px;color:#1DB954;display:none}
.pl-track-row.active .pl-tr-num{display:none}
.pl-track-row.active .pl-tr-icon{display:block}
.pl-tr-info{flex:1;min-width:0}
.pl-tr-name{font-size:.78rem;font-weight:500;color:rgba(255,255,255,.7);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.pl-track-row.active .pl-tr-name{color:#fff}
.pl-track-row:hover .pl-tr-name{color:#fff}
.pl-tr-artist{font-size:.66rem;color:rgba(255,255,255,.28)}
.pl-tr-genre{font-size:.55rem;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;padding:3px 9px;border-radius:999px;border:1px solid rgba(255,255,255,.08);color:rgba(255,255,255,.3);flex-shrink:0}
.pl-tr-lv{display:flex;gap:2px;flex-shrink:0}
.pl-tr-pip{width:4px;height:4px;border-radius:50%;background:rgba(255,255,255,.08)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   APOIA-SE PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
/* #page-apoiase display handled by .page.active + #page-apoiase.active rules above */
.ap-bg{position:fixed;inset:0;pointer-events:none;background:radial-gradient(ellipse 60% 60% at 30% 70%,rgba(255,180,50,.07) 0,transparent 55%),radial-gradient(ellipse 50% 50% at 70% 30%,rgba(100,60,200,.07) 0,transparent 55%)}
.ap-inner{position:relative;z-index:3;max-width:600px;padding:60px 40px 80px;text-align:center;margin:0 auto;display:flex;flex-direction:column;align-items:center;}
.ap-icon{font-size:3rem;margin-bottom:24px;animation:float 3s ease-in-out infinite}
.ap-eyebrow{font-size:.6rem;font-weight:700;letter-spacing:4px;text-transform:uppercase;color:rgba(255,180,50,.8);margin-bottom:16px;display:flex;align-items:center;justify-content:center;gap:10px}
.ap-eyebrow::before,.ap-eyebrow::after{content:'';width:20px;height:1px;background:rgba(255,180,50,.5)}
.ap-title{font-family:'Cormorant Garamond',serif;font-size:clamp(2.4rem,5vw,4rem);font-weight:300;letter-spacing:-2px;color:#fff;margin-bottom:16px;line-height:.93}
.ap-title em{font-style:italic;color:rgba(255,255,255,.32)}
.ap-desc{font-size:.88rem;line-height:1.9;color:rgba(255,255,255,.4);font-weight:300;margin-bottom:40px}
.ap-cards{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;margin-bottom:40px}
.ap-card{
  flex:1;min-width:150px;max-width:180px;
  padding:24px 20px;border-radius:18px;
  border:1px solid rgba(255,255,255,.08);background:rgba(255,255,255,.03);
  text-align:center;transition:all .25s;cursor:default;
  backdrop-filter:blur(10px);
}
.ap-card-val{font-family:'Cormorant Garamond',serif;font-size:1.8rem;font-weight:300;color:#fff;margin-bottom:4px}
.ap-card-label{font-size:.6rem;letter-spacing:1.5px;text-transform:uppercase;color:rgba(255,255,255,.28)}
.ap-btn{
  display:inline-flex;align-items:center;gap:10px;
  padding:16px 32px;border-radius:999px;
  background:rgba(255,180,50,.15);border:1px solid rgba(255,180,50,.4);
  color:#ffb432;font-size:.78rem;font-weight:600;letter-spacing:1px;
  text-decoration:none;transition:all .25s;text-transform:uppercase;
  cursor:pointer;
}
.ap-btn:hover{background:rgba(255,180,50,.25);transform:translateY(-2px);box-shadow:0 12px 32px rgba(255,180,50,.15)}
.ap-note{margin-top:20px;font-size:.65rem;color:rgba(255,255,255,.18);letter-spacing:.5px}

/* Feedback box */
.ap-feedback{margin-top:40px;width:100%;max-width:420px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.08);border-radius:18px;padding:28px 24px}
.ap-fb-title{font-size:.62rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:rgba(255,255,255,.3);margin-bottom:16px;display:flex;align-items:center;gap:8px}
.ap-fb-title::before{content:'';width:18px;height:1px;background:rgba(255,255,255,.2)}
.ap-fb-textarea{width:100%;background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.1);border-radius:12px;padding:14px 16px;font-family:'DM Sans',sans-serif;font-size:.8rem;color:rgba(255,255,255,.7);line-height:1.6;resize:vertical;min-height:90px;outline:none;transition:border-color .2s}
.ap-fb-textarea::placeholder{color:rgba(255,255,255,.2)}
.ap-fb-textarea:focus{border-color:rgba(255,180,50,.4)}
.ap-fb-row{display:flex;align-items:center;justify-content:space-between;margin-top:12px;gap:10px}
.ap-fb-note{font-size:.6rem;color:rgba(255,255,255,.18);flex:1}
.ap-fb-btn{display:inline-flex;align-items:center;gap:6px;padding:9px 18px;border-radius:999px;background:rgba(255,180,50,.12);border:1px solid rgba(255,180,50,.3);color:#ffb432;font-size:.68rem;font-weight:600;letter-spacing:.8px;cursor:pointer;transition:all .2s;text-transform:uppercase;flex-shrink:0}
.ap-fb-btn:hover{background:rgba(255,180,50,.22);transform:translateY(-1px)}
.ap-fb-btn:disabled{opacity:.4;cursor:not-allowed;transform:none}
.ap-fb-success{margin-top:12px;font-size:.72rem;color:#1DB954;display:none;align-items:center;gap:6px}
.ap-fb-success.show{display:flex}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RATING PANEL (floating)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#rating-panel{
  position:fixed;bottom:28px;right:28px;z-index:7000;
  width:300px;background:rgba(10,10,20,.96);
  border:1px solid rgba(255,255,255,.1);border-radius:20px;
  padding:20px;backdrop-filter:blur(24px);
  box-shadow:0 20px 60px rgba(0,0,0,.7);
  transform:translateY(120%);opacity:0;
  transition:transform .4s cubic-bezier(.22,1,.36,1),opacity .3s;
  pointer-events:none;
}
#rating-panel.visible{transform:translateY(0);opacity:1;pointer-events:all}
.rp-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:12px}
.rp-track{font-size:.6rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:var(--rpc,#1DB954);flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;padding-right:8px}
.rp-close{width:22px;height:22px;border-radius:50%;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);color:rgba(255,255,255,.4);font-size:11px;cursor:pointer;display:flex;align-items:center;justify-content:center;flex-shrink:0;transition:all .2s}
.rp-close:hover{background:rgba(255,255,255,.12);color:#fff}
.rp-question{font-size:.78rem;line-height:1.55;color:rgba(255,255,255,.75);margin-bottom:16px;font-weight:300}
.rp-stars{display:flex;gap:4px;justify-content:center;margin-bottom:16px;cursor:pointer}
.rp-star{font-size:1.6rem;color:rgba(255,255,255,.12);transition:color .15s;line-height:1;user-select:none}
.rp-star.half{color:var(--rpc,#1DB954);opacity:.55}
.rp-star.full{color:var(--rpc,#1DB954)}
.rp-value{text-align:center;font-size:.65rem;color:rgba(255,255,255,.3);margin-bottom:14px;height:14px;transition:opacity .2s}
.rp-actions{display:flex;gap:8px}
.rp-btn-skip{flex:1;padding:9px;border-radius:10px;border:1px solid rgba(255,255,255,.1);background:transparent;color:rgba(255,255,255,.3);font-size:.65rem;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.rp-btn-skip:hover{border-color:rgba(255,255,255,.2);color:rgba(255,255,255,.6)}
.rp-btn-rate{flex:2;padding:9px;border-radius:10px;border:1px solid var(--rpc,#1DB954);background:rgba(29,185,84,.1);color:var(--rpc,#1DB954);font-size:.65rem;font-weight:700;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s;opacity:.35}
.rp-btn-rate.ready{opacity:1}
.rp-btn-rate:hover.ready{background:rgba(29,185,84,.2)}
.rp-progress{margin-top:14px;display:flex;gap:3px;justify-content:center}
.rp-pdot{width:5px;height:5px;border-radius:50%;background:rgba(255,255,255,.1);transition:background .2s}
.rp-pdot.rated{background:var(--rpc,#1DB954)}
.rp-pdot.skipped{background:rgba(255,255,255,.25)}
.rp-pdot.current{background:rgba(255,255,255,.5);box-shadow:0 0 6px rgba(255,255,255,.4)}

/* â”€â”€ Report modal â”€â”€ */
#report-overlay{
  position:fixed;inset:0;z-index:9500;
  background:rgba(3,3,10,.85);backdrop-filter:blur(20px);
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;transition:opacity .3s;
  padding:20px;
}
#report-overlay.open{opacity:1;pointer-events:all}
.report-box{
  position:relative;width:100%;max-width:580px;max-height:92vh;overflow-y:auto;
  background:rgba(12,12,22,.98);border:1px solid rgba(255,255,255,.1);
  border-radius:24px;padding:40px 36px;
  box-shadow:0 32px 80px rgba(0,0,0,.9);
  transform:translateY(20px) scale(.97);transition:transform .35s;
}
#report-overlay.open .report-box{transform:translateY(0) scale(1)}
.report-close{position:absolute;top:16px;right:16px;width:32px;height:32px;border-radius:50%;border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.05);color:rgba(255,255,255,.5);font-size:14px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}
.report-close:hover{background:rgba(255,255,255,.12);color:#fff}
.report-eyebrow{font-size:.58rem;font-weight:700;letter-spacing:3px;text-transform:uppercase;color:#1DB954;margin-bottom:16px;display:flex;align-items:center;gap:8px}
.report-eyebrow::before{content:'';width:18px;height:1px;background:#1DB954}
.report-title{font-family:'Cormorant Garamond',serif;font-size:clamp(1.8rem,4vw,2.8rem);font-weight:300;letter-spacing:-2px;color:#fff;margin-bottom:4px;line-height:1}
.report-subtitle{font-size:.78rem;color:rgba(255,255,255,.35);margin-bottom:28px;font-weight:300}
.report-score-row{display:flex;align-items:center;gap:16px;margin-bottom:28px;padding:20px;background:rgba(255,255,255,.03);border:1px solid rgba(255,255,255,.07);border-radius:16px}
.report-big-stars{display:flex;gap:4px}
.report-big-star{font-size:1.8rem;line-height:1}
.report-big-star.full{color:#1DB954}
.report-big-star.half{color:#1DB954;opacity:.5}
.report-big-star.empty{color:rgba(255,255,255,.1)}
.report-score-info{flex:1}
.report-score-num{font-family:'Cormorant Garamond',serif;font-size:2.4rem;font-weight:300;color:#fff;line-height:1}
.report-score-label{font-size:.6rem;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.28);margin-top:2px}
.report-cats{display:grid;grid-template-columns:1fr 1fr 1fr;gap:10px;margin-bottom:24px}
.report-cat{padding:16px 12px;border-radius:14px;border:1px solid rgba(255,255,255,.07);background:rgba(255,255,255,.02);text-align:center}
.report-cat-icon{font-size:1.4rem;margin-bottom:6px}
.report-cat-name{font-size:.55rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.3);margin-bottom:8px}
.report-cat-stars{display:flex;gap:2px;justify-content:center;margin-bottom:4px}
.report-cat-star{font-size:.8rem}
.report-cat-star.full{color:#1DB954}
.report-cat-star.half{color:#1DB954;opacity:.5}
.report-cat-star.empty{color:rgba(255,255,255,.12)}
.report-cat-val{font-size:.65rem;color:rgba(255,255,255,.35)}
.report-cat.insufficient{border-color:rgba(255,100,100,.2);background:rgba(255,100,100,.04)}
.report-cat.insufficient .report-cat-name{color:rgba(255,100,100,.5)}
.report-divider{height:1px;background:rgba(255,255,255,.06);margin:20px 0}
.report-insights{display:flex;flex-direction:column;gap:10px;margin-bottom:24px}
.report-insight{display:flex;gap:12px;align-items:flex-start;padding:12px 14px;border-radius:12px;background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06)}
.report-insight-icon{font-size:1rem;flex-shrink:0;margin-top:1px}
.report-insight-text{font-size:.76rem;line-height:1.6;color:rgba(255,255,255,.55);font-weight:300}
.report-insight-text strong{color:rgba(255,255,255,.8);font-weight:500}
.report-footer{text-align:center;font-size:.65rem;color:rgba(255,255,255,.2);line-height:1.7}
.report-btn-retry{display:inline-flex;align-items:center;gap:8px;margin-top:20px;padding:12px 24px;border-radius:999px;border:1px solid rgba(29,185,84,.3);background:rgba(29,185,84,.08);color:#1DB954;font-size:.68rem;font-weight:600;letter-spacing:1px;text-transform:uppercase;cursor:pointer;transition:all .2s}
.report-btn-retry:hover{background:rgba(29,185,84,.18);transform:translateY(-2px)}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MOBILE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
@media(max-width:768px){
  body{cursor:auto}
  #cur,#curR{display:none}
  #header{padding:0 16px;height:56px}
  #page-wrapper{top:56px}
  .nav-brand-sub{display:none}
  .nav-brand-name{font-size:.62rem}
  .nav-brand-icon{width:22px;height:22px}
  .nav-link{padding:6px 8px;font-size:.54rem;letter-spacing:1px}
  .home-hero{padding:0 24px;min-height:calc(100vh - 56px)}
  .home-h1{font-size:clamp(2.8rem,10vw,4rem);letter-spacing:-2px}
  .home-sub{font-size:.82rem}
  .home-nav-cards{gap:8px}
  .hnc{min-width:130px;padding:14px 16px}
  .home-scroll{left:24px;bottom:24px}
  .home-challenges{padding:48px 24px 64px}
  .challenge-cards{grid-template-columns:1fr 1fr}
  .exp-about-inner{padding:0 24px}
  .exp-ch-inner{padding:0 16px}
  .exp-ch-grid{grid-template-columns:repeat(3,1fr)}
  .t-nav{padding:0 20px}
  .t-content{grid-template-columns:1fr;gap:0;padding:72px 24px 24px;align-items:center;justify-items:center;text-align:center}
  .challenge-label{justify-content:center}
  .challenge-label::before{display:none}
  .t-title{font-size:clamp(1.9rem,8vw,2.8rem);letter-spacing:-1.5px}
  .t-artist{font-size:.78rem;margin-bottom:14px}
  .t-desc{font-size:.74rem;border-left:none;border-top:2px solid var(--tc,#1DB954);padding-left:0;padding-top:10px;text-align:left;max-width:100%}
  .t-player{gap:14px;width:100%;align-items:center;padding-top:16px}
  .vinyl{width:120px;height:120px}
  .waveform{height:28px}
  #exp-sdots{right:10px}
  .pl-page-inner{padding:40px 20px 80px}
  .pl-controls{flex-wrap:wrap;gap:8px}
  .ap-inner{padding:0 24px}
  .ap-cards{gap:10px}
  .ap-card{min-width:120px;padding:18px 14px}
  /* Modal mobile fix */
  #modal-overlay{padding:10px;align-items:flex-end}
  .modal-box{padding:24px 20px;border-radius:20px 20px 14px 14px;max-height:88vh}
  .modal-title{font-size:clamp(1.5rem,7vw,2.2rem)}
  .modal-vinyl{width:80px;height:80px}
  .modal-player>div:first-child{flex-direction:column;align-items:center;gap:12px}
  .modal-waveform{justify-content:center}
}
@media(max-width:390px){
  .exp-ch-grid{grid-template-columns:repeat(2,1fr)}
  .challenge-cards{grid-template-columns:1fr}
}
</style>
</head>
<body>

<div id="cur"></div>
<div id="curR"></div>
<div id="toast"><span class="t-icon">ðŸŽµ</span><span id="toast-msg"></span></div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<header id="header">
  <span class="nav-brand" onclick="nav('home')">
    <svg class="nav-brand-icon" viewBox="0 0 28 28" fill="none" xmlns="http://www.w3.org/2000/svg">
      <!-- Earbud shape -->
      <circle cx="14" cy="14" r="13" fill="rgba(29,185,84,0.12)" stroke="rgba(29,185,84,0.4)" stroke-width="1"/>
      <!-- Earbud body -->
      <ellipse cx="14" cy="13" rx="5.5" ry="6" fill="rgba(29,185,84,0.25)" stroke="#1DB954" stroke-width="1.2"/>
      <!-- Speaker grille dots -->
      <circle cx="14" cy="12" r="1.2" fill="#1DB954"/>
      <circle cx="11.8" cy="14" r=".6" fill="#1DB954" opacity=".5"/>
      <circle cx="16.2" cy="14" r=".6" fill="#1DB954" opacity=".5"/>
      <!-- Ear tip -->
      <path d="M10.5 17.5 Q14 20.5 17.5 17.5" stroke="#1DB954" stroke-width="1.2" fill="none" stroke-linecap="round"/>
      <!-- Sound waves -->
      <path d="M4 10 Q5.5 14 4 18" stroke="rgba(29,185,84,0.4)" stroke-width="1" fill="none" stroke-linecap="round"/>
      <path d="M24 10 Q22.5 14 24 18" stroke="rgba(29,185,84,0.4)" stroke-width="1" fill="none" stroke-linecap="round"/>
    </svg>
    <span class="nav-brand-text">
      <span class="nav-brand-name">Hertz Hunt</span>
      <span class="nav-brand-sub">Teste de Fone</span>
    </span>
  </span>
  <nav class="nav-links">
    <span class="nav-link active" data-page="home" onclick="nav('home')">Home</span>
    <span class="nav-link" data-page="experience" onclick="nav('experience')">Experience</span>
    <span class="nav-link" data-page="playlist" onclick="nav('playlist')">Playlist</span>
    <span class="nav-link" data-page="apoiase" onclick="nav('apoiase')">Apoia-se</span>
  </nav>
</header>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     MODAL POPUP
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="modal-overlay" onclick="closeModal(event)">
  <div class="modal-box" id="modal-box">
    <button class="modal-close" onclick="closeModal(null,true)">âœ•</button>
    <div id="modal-genre-badge" class="modal-genre-badge"></div>
    <p class="modal-challenge" id="modal-ch-label"></p>
    <h2 class="modal-title" id="modal-title"></h2>
    <p class="modal-artist" id="modal-artist"></p>
    <p class="modal-desc" id="modal-desc"></p>
    <div class="modal-diff">
      <span class="modal-diff-label">Dificuldade</span>
      <div class="modal-diff-pips" id="modal-diff-pips"></div>
    </div>
    <div class="modal-player">
      <div style="display:flex;align-items:center;gap:20px;width:100%">
        <div class="modal-vinyl" id="modal-vinyl"></div>
        <div style="flex:1;display:flex;flex-direction:column;gap:14px">
          <div class="modal-waveform" id="modal-waveform">
            <!-- bars injected by JS -->
          </div>
          <div class="modal-controls">
            <button class="modal-play-btn" id="modal-play-btn" onclick="modalPlayClick()">â–¶</button>
            <a class="modal-sp-btn" id="modal-sp-btn" href="#" target="_blank" rel="noopener">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="#1DB954"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
              Spotify
            </a>
          </div>
        </div>
      </div>
      <div class="modal-prog" style="width:100%">
        <div class="modal-track-bar" id="modal-bar" onclick="modalSeek(event)">
          <div class="modal-track-fill" id="modal-fill"></div>
        </div>
        <div class="modal-times"><span id="modal-tm">0:00</span><span id="modal-dur">â€”</span></div>
      </div>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PAGE WRAPPER (isola as abas do body)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-wrapper">

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     HOME PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-home" class="page active">

  <!-- Hero -->
  <div class="home-hero noise">
    <div class="home-hero-bg"></div>
    <div class="home-hero-inner">
      <p class="home-eyebrow">20 desafios sonoros</p>
      <h1 class="home-h1">AtÃ© onde vai<br/><em>o seu fone?</em></h1>
      <p class="home-sub">Uma experiÃªncia imersiva projetada para levar cada frequÃªncia do seu headphone ao limite â€” graves, agudos, dinÃ¢mica, espaÃ§o sonoro e muito mais.</p>
      <div class="home-nav-cards">
        <div class="hnc" style="--hc:#1DB954" onclick="nav('experience')">
          <span class="hnc-label">Experience</span>
          <span class="hnc-title">O teste</span>
          <span class="hnc-desc">20 mÃºsicas, 5 nÃ­veis, um fone no limite.</span>
          <span class="hnc-arrow">â†‘ cabeÃ§alho</span>
        </div>
        <div class="hnc" style="--hc:#5c9de0" onclick="nav('playlist')">
          <span class="hnc-label">Playlist</span>
          <span class="hnc-title">As faixas</span>
          <span class="hnc-desc">OuÃ§a e salve no Spotify.</span>
          <span class="hnc-arrow">â†‘ cabeÃ§alho</span>
        </div>
        <div class="hnc" style="--hc:#ffb432" onclick="nav('apoiase')">
          <span class="hnc-label">Apoia-se</span>
          <span class="hnc-title">Apoie</span>
          <span class="hnc-desc">Gostou? Ajude a manter o projeto.</span>
          <span class="hnc-arrow">â†‘ cabeÃ§alho</span>
        </div>
      </div>
    </div>
    <div class="home-scroll"><span class="home-scroll-dot"></span>Role para ver os desafios</div>
  </div>

  <!-- Challenges by level -->
  <div class="home-challenges">
    <div class="home-challenges-header">
      <p class="hch-eyebrow">Os desafios</p>
      <h2 class="hch-title">Clique e<br/><em>teste agora</em></h2>
    </div>
    <div id="home-challenges-body"></div>
  </div>

</div><!-- /page-home -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     EXPERIENCE PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-experience" class="page">
  <div id="exp-sdots"></div>
  <div class="exp-scroll-container" id="exp-scroll">

    <!-- Tela 1: coloque o fone -->
    <div class="exp-section" id="exp-intro">
      <div class="exp-intro-bg"></div>
      <div class="exp-intro-inner" style="position:relative;z-index:3">
        <div class="exp-headphone-icon">ðŸŽ§</div>
        <h2 class="exp-intro-title">Coloque o fone<br/><em>nos dois ouvidos</em></h2>
        <p class="exp-intro-sub">Para uma experiÃªncia completa, use fones com os dois canais. O teste foi desenhado para a escuta binaural â€” cada detalhe importa.</p>
        <button class="exp-play-btn" onclick="expGoToAbout()">â–¶</button>
      </div>
    </div>

    <!-- Tela 2: sobre a experiÃªncia -->
    <div class="exp-section" id="exp-about">
      <div class="exp-about-bg"></div>
      <div class="exp-about-inner">
        <p class="exp-about-eyebrow">A experiÃªncia</p>
        <h2 class="exp-about-title">20 mÃºsicas.<br/><em>Um fone.</em></h2>
        <p class="exp-about-body">Cada faixa foi escolhida para desafiar uma caracterÃ­stica diferente do seu headphone. HÃ¡ mÃºsicas que testam o grave profundo, outras que exigem agilidade nos agudos, separaÃ§Ã£o de instrumentos, dinÃ¢mica orquestral e muito mais.<br/><br/>Cada desafio tem um nÃ­vel de dificuldade: do <strong>Aquecimento</strong> atÃ© o <strong>Extremo</strong>. Role para ver todos os desafios e, em seguida, a experiÃªncia comeÃ§a automaticamente.</p>
        <div class="exp-about-cta">Role para continuar <div class="exp-about-arrow"></div></div>
      </div>
    </div>

    <!-- Tela 3: grid de desafios -->
    <div class="exp-section" id="exp-challenges">
      <div class="exp-ch-bg"></div>
      <div class="exp-ch-inner">
        <h2 class="exp-ch-title">Os <em>desafios</em></h2>
        <div class="exp-ch-grid" id="exp-ch-grid"></div>
      </div>
    </div>

    <!-- Faixas injected by JS -->
    <div id="exp-tracks"></div>

  </div><!-- /exp-scroll-container -->
</div><!-- /page-experience -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     PLAYLIST PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-playlist" class="page">
  <div class="pl-page-inner">

    <div class="pl-header">
      <p class="pl-eyebrow">A trilha do teste</p>
      <h2 class="pl-title">Playlist<br/><em>completa</em></h2>
      <div class="pl-meta">
        <span class="pl-count-badge">20 faixas Â· 5 nÃ­veis</span>
        <a class="pl-sp-link" href="https://open.spotify.com/playlist/4N9QsntuVrFVrEl92QsjhK?si=6H9e25v2SriAtCZQiVH9ug" target="_blank" rel="noopener">
          <svg width="14" height="14" viewBox="0 0 24 24" fill="#1DB954"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
          Abrir no Spotify
        </a>
      </div>
    </div>

    <!-- Controls bar -->
    <div class="pl-controls" id="pl-controls">
      <button class="pl-ctrl-btn" id="pl-prev-btn" onclick="plPrev()" title="Anterior">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="19 20 9 12 19 4"/><line x1="5" y1="4" x2="5" y2="20"/></svg>
      </button>
      <button class="pl-ctrl-btn" id="pl-play-btn" onclick="plPlayPause()">â–¶</button>
      <button class="pl-ctrl-btn" id="pl-next-btn" onclick="plNext()" title="PrÃ³xima">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="5 4 15 12 5 20"/><line x1="19" y1="4" x2="19" y2="20"/></svg>
      </button>
      <div class="pl-now-playing">
        <div class="pl-np-track" id="pl-np-track">â€”</div>
        <div class="pl-np-artist" id="pl-np-artist">Selecione uma faixa</div>
      </div>
      <div class="pl-progress-wrap">
        <div class="pl-prog-bar" id="pl-prog-bar" onclick="plSeek(event)">
          <div class="pl-prog-fill" id="pl-prog-fill"></div>
        </div>
        <div class="pl-times"><span id="pl-tm">0:00</span><span id="pl-dur">â€”</span></div>
      </div>
    </div>

    <div class="pl-track-list" id="pl-track-list"></div>

  </div>
</div><!-- /page-playlist -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     APOIA-SE PAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="page-apoiase" class="page">
  <div class="ap-bg"></div>
  <div class="ap-inner">
    <div class="ap-icon">â¤ï¸</div>
    <p class="ap-eyebrow">Apoie o projeto</p>
    <h2 class="ap-title">Feito com<br/><em>muito carinho</em></h2>
    <p class="ap-desc">Este site Ã© gratuito, sem anÃºncios e feito por amor Ã  mÃºsica e ao bom Ã¡udio. Se vocÃª curtiu a experiÃªncia e quiser ajudar a manter o projeto no ar, qualquer contribuiÃ§Ã£o Ã© muito bem-vinda.</p>
    <div class="ap-cards">
      <div class="ap-card"><div class="ap-card-val">â˜•</div><div class="ap-card-label">Um cafÃ©</div></div>
      <div class="ap-card"><div class="ap-card-val">ðŸŽµ</div><div class="ap-card-label">Uma faixa</div></div>
      <div class="ap-card"><div class="ap-card-val">ðŸŽ§</div><div class="ap-card-label">Um upgrade</div></div>
    </div>
    <a class="ap-btn" href="https://www.paypal.com/donate/?business=78H7QSAAB487J&no_recurring=0&currency_code=BRL" target="_blank" rel="noopener">
      ðŸ’› Quero apoiar
    </a>
    <p class="ap-note">Pagamento seguro via PayPal Â· Qualquer valor Ã© bem-vindo ðŸ’›</p>

    <!-- Feedback box -->
    <div class="ap-feedback">
      <p class="ap-fb-title">Deixe sua sugestÃ£o</p>
      <textarea class="ap-fb-textarea" id="ap-fb-text" placeholder="Conta o que vocÃª achou, o que melhoraria, o que sentiu faltaâ€¦"></textarea>
      <div class="ap-fb-row">
        <span class="ap-fb-note">Nenhum cadastro necessÃ¡rio.</span>
        <button class="ap-fb-btn" id="ap-fb-send" onclick="sendFeedback()">âœ‰ Enviar</button>
      </div>
      <div class="ap-fb-success" id="ap-fb-success">âœ“ Enviado! Obrigado pela contribuiÃ§Ã£o.</div>
    </div>
  </div>
</div><!-- /page-apoiase -->

</div><!-- /page-wrapper -->

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     RATING PANEL (floating, over experience)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="rating-panel">
  <div class="rp-header">
    <span class="rp-track" id="rp-track-name">â€”</span>
    <button class="rp-close" onclick="rpSkip()" title="Fechar">âœ•</button>
  </div>
  <p class="rp-question" id="rp-question">â€”</p>
  <div class="rp-stars" id="rp-stars"></div>
  <div class="rp-value" id="rp-value"></div>
  <div class="rp-actions">
    <button class="rp-btn-skip" onclick="rpSkip()">Pular</button>
    <button class="rp-btn-rate" id="rp-btn-rate" onclick="rpConfirm()">Avaliar</button>
  </div>
  <div class="rp-progress" id="rp-progress"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     REPORT MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="report-overlay">
  <div class="report-box">
    <button class="report-close" onclick="closeReport()">âœ•</button>
    <p class="report-eyebrow">Resultado</p>
    <h2 class="report-title" id="rep-title">RelatÃ³rio do Fone</h2>
    <p class="report-subtitle" id="rep-subtitle"></p>
    <div class="report-score-row">
      <div class="report-big-stars" id="rep-big-stars"></div>
      <div class="report-score-info">
        <div class="report-score-num" id="rep-score-num">â€”</div>
        <div class="report-score-label">nota geral</div>
      </div>
    </div>
    <div class="report-cats" id="rep-cats"></div>
    <div class="report-divider"></div>
    <div class="report-insights" id="rep-insights"></div>
    <div class="report-footer">
      AvaliaÃ§Ã£o baseada em <span id="rep-rated-count">â€”</span> mÃºsicas ouvidas.<br/>
      Os resultados refletem a sua percepÃ§Ã£o auditiva e as caracterÃ­sticas do seu fone.
      <br/><br/>
      <button class="report-btn-retry" onclick="closeReport()">â†© Voltar Ã  experiÃªncia</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
     JAVASCRIPT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<script>
/* â”€â”€â”€ DATA â”€â”€â”€ */
const GC={'Metal Progressivo':'#e05c5c','Rock':'#e07a2f','Groove':'#d4c44a','Pop':'#5c9de0','Pop Alternative':'#a05ce0','R&B':'#e05c9d','Soul':'#e09a5c','Sertanejo':'#5ce07a','Pagode':'#5ccfe0','Rap Brasileiro':'#e0c45c','EletrÃ´nica':'#5c7ae0'};
const GG={'Metal Progressivo':'#7a1515','Rock':'#7a3a0a','Groove':'#6a600a','Pop':'#0a3a7a','Pop Alternative':'#3a0a7a','R&B':'#7a0a40','Soul':'#7a4a0a','Sertanejo':'#0a7a2f','Pagode':'#0a5a7a','Rap Brasileiro':'#7a5a0a','EletrÃ´nica':'#0a1a7a'};
const LE=['','ðŸŸ¢','ðŸŸ¡','ðŸŸ ','ðŸ”´','ðŸ’€'];
const LL=['','Aquecimento','MÃ©dio','DifÃ­cil','AvanÃ§ado','Extremo'];

const T=[
  {lv:1,ch:"SeparaÃ§Ã£o de graves, hi-hats e guitarra.",d:'Uma danÃ§a disfarÃ§ada de teste. Se vocÃª nÃ£o quiser balanÃ§ar a cabeÃ§a, o fone nÃ£o estÃ¡ entregando o ritmo certo.',g:"Groove",s:"Get Lucky",a:"Daft Punk ft. Pharrell",sid:"69kOkLUCkxIZYexIgSG8rq",fq:"mid",q:"VocÃª conseguiu ouvir o ritmo da guitarra e os detalhes da bateria separados, sem virar uma mistura sÃ³?"},
  {lv:1,ch:"DistinÃ§Ã£o entre synth e linha de baixo.",d:'O sintetizador brilhante que fez essa mÃºsica um hit precisa chegar atÃ© vocÃª. Se parecer abafado, seu fone estÃ¡ engolindo o brilho.',g:"Pop",s:"Blinding Lights",a:"The Weeknd",sid:"0VjIjW4GlUZAMYd2vXMi3b",fq:"high",q:"O brilho do sintetizador chegou nÃ­tido e vibrante, ou pareceu apagado e sem energia?"},
  {lv:1,ch:"Agudos vibrantes sem distorÃ§Ã£o.",d:'O agudo icÃ´nico do Rei do Pop precisa ser vibrante e energÃ©tico. Se raspar ou sumir, seu fone estÃ¡ perdendo o alto da mÃºsica.',g:"Groove",s:"Don't Stop 'Til You Get Enough",a:"Michael Jackson",sid:"5ChkMS8OtdzJeqyybCc9R5",fq:"high",q:"Os agudos e a voz do Michael Jackson chegaram vivos e sem chiado, ou pareceram duros e cansativos?"},
  {lv:2,ch:"Baixo robusto sem mascarar a voz.",d:'O segredo aqui Ã© ouvir o baixo robusto e a voz da Miley ao mesmo tempo, sem um abafar o outro. Fone fraco borra tudo numa lama sÃ³.',g:"Pop",s:"Flowers",a:"Miley Cyrus",sid:"0yLdNVWF3Srea0uzk55zFn",fq:"low",q:"O grave estava presente e firme sem abafar a voz? VocÃª conseguiu ouvir os dois ao mesmo tempo com clareza?"},
  {lv:2,ch:"Resposta de frequÃªncia em barÃ­tono.",d:'Essa voz profunda de barÃ­tono precisa ter peso e calor. Se parecer nasal ou fina, o fone estÃ¡ cortando as frequÃªncias que fazem a diferenÃ§a.',g:"Soul",s:"No Love Dying",a:"Gregory Porter",sid:"2g9JIMhVlHpbHPdnGbfOkY",fq:"low",q:"A voz grave do cantor soou encorpada e quente, ou pareceu fina e sem corpo?"},
  {lv:2,ch:"Imagem estÃ©reo e extensÃ£o nos graves.",d:'Feche os olhos. A orquestra deve crescer ao seu redor e a voz deve parecer estar bem na sua frente. Ã‰ a diferenÃ§a entre ouvir e sentir.',g:"Soul",s:"Feeling Good",a:"Nina Simone",sid:"4mMbgHuoHEleRi4vFj0RgK",fq:"mid",q:"Com os olhos fechados, vocÃª sentiu os instrumentos ao redor e a voz bem na sua frente, como se estivesse no palco?"},
  {lv:2,ch:"Agudos controlados sem sibilÃ¢ncia.",d:'A voz da Hayley Williams Ã© intensa e cheia de energia. Se vocÃª sentir um chiado ou dor no ouvido, seu fone estÃ¡ exagerando nos agudos.',g:"Rock",s:"Misery Business",a:"Paramore",sid:"0ByMNEPAPpOR5H69DVrTNy",fq:"high",q:"VocÃª conseguiu ouvir a voz da cantora claramente e com energia, sem chiado ou dor no ouvido?"},
  {lv:3,ch:"EquilÃ­brio espectral entre sub-grave e mÃ©dios.",d:'Aqui o grave deve ser como uma neblina suave â€” presente em todo lugar, mas sem apagar a voz delicada. EquilÃ­brio Ã© tudo.',g:"R&B",s:"telepatÃ­a",a:"Kali Uchis",sid:"6Fht4kI3PtAAPEFsGiSQSf",fq:"low",q:"O grave estava presente e envolvente sem abafar a voz delicada da cantora? Os dois coexistiram bem?"},
  {lv:3,ch:"Peso do bumbo sem mascarar as vozes.",d:'O bumbo da viola sertaneja precisa ter peso, mas sem engolir as vozes. Se parecer que vocÃª estÃ¡ lÃ¡ na frente do palco, o fone passou.',g:"Sertanejo",s:"ArranhÃ£o",a:"Henrique e Juliano",sid:"3FQNkc3mPPCqTFUCDhULUQ",fq:"low",q:"O bumbo soou com peso e impacto, mas sem engolir as vozes dos cantores?"},
  {lv:3,ch:"Ataque seco e rÃ¡pido do pandeiro.",d:'Cada batida do pandeiro precisa ter aquele estalo seco e rÃ¡pido. Se soar borrado ou lento, seu fone nÃ£o estÃ¡ acompanhando o ritmo do pagode.',g:"Pagode",s:"PÃ© Na Areia",a:"Diogo Nogueira",sid:"0Qhqz8MJc4IpjJJnTGjEPM",fq:"high",q:"Cada batida do pandeiro soou seca e bem definida, ou pareceu borrada e sem precisÃ£o?"},
  {lv:3,ch:"DistinÃ§Ã£o de instrumentos em conjunto ao vivo.",d:'Ao vivo, sÃ£o vÃ¡rios mÃºsicos tocando ao mesmo tempo. Seu fone deve deixar vocÃª distinguir cada um deles, sem virar uma bagunÃ§a sonora.',g:"Pagode",s:"Sinal Vital",a:"Sorriso Maroto",sid:"1qDrGZsQmMGcJJMvnOGIas",fq:"mid",q:"VocÃª conseguiu distinguir os instrumentos individualmente, ou tudo soou junto numa bagunÃ§a?"},
  {lv:4,ch:"Clareza no caos: bateria, guitarra e voz.",d:'Bateria acelerada, guitarras distorcidas e voz gritada. Tudo ao mesmo tempo. O fone precisa manter a clareza no caos total.',g:"Rock",s:"Basket Case",a:"Green Day",sid:"7EjyzZcaLBFFNYfZFfjMk4",fq:"mid",q:"No meio do caos da mÃºsica, bateria, guitarra e voz chegaram com clareza ou tudo virou uma parede de ruÃ­do?"},
  {lv:4,ch:"Voz delicada sobre sub-grave pesado.",d:'A Billie sussurra enquanto o grave bombeia pesado. Seu fone precisa entregar os dois sem deixar a voz delicada desaparecer no meio do baixo.',g:"Pop Alternative",s:"bad guy",a:"Billie Eilish",sid:"2Fxmhks0bxGSBdJ92vM42m",fq:"low",q:"O grave estava pesado e presente, mas a voz sussurrada da Billie ainda dava para ouvir com nitidez?"},
  {lv:4,ch:"ReproduÃ§Ã£o firme e seca do 808.",d:'Esse bumbo eletrÃ´nico pesado (o famoso 808) precisa ser firme e seco, quase fÃ­sico. Se parecer frouxo ou distorcido, seu fone nÃ£o aguentou.',g:"R&B",s:"MONACO",a:"Bad Bunny",sid:"4Ft8GHFvj8qlHE0Mry1Xhq",fq:"low",q:"O bumbo eletrÃ´nico soou firme e com impacto fÃ­sico, ou pareceu mole e sem definiÃ§Ã£o?"},
  {lv:4,ch:"AusÃªncia de distorÃ§Ã£o em picos vocais.",d:'No refrÃ£o, a voz da Simone vai ao limite. Se seu fone comeÃ§ar a distorcer nos momentos mais intensos, ele nÃ£o tem potÃªncia suficiente.',g:"Sertanejo",s:"Erro Gostoso",a:"Simone Mendes",sid:"3dJZR8vg6rj4lkANIfazpz",fq:"high",q:"Nos momentos mais intensos do refrÃ£o, a voz ficou limpa ou vocÃª notou alguma distorÃ§Ã£o ou aspereza?"},
  {lv:4,ch:"Resposta Ã  transiÃ§Ã£o de dinÃ¢mica extrema.",d:'ComeÃ§a suave e explode. A transiÃ§Ã£o entre o trecho calmo e o drop cheio Ã© o teste definitivo: seu fone precisa te surpreender na virada.',g:"Pop Alternative",s:"Hi-Lo (Hollow)",a:"Bishop Briggs",sid:"2x5MXKQZ6HHSA2cMCgPWTx",fq:"mid",q:"A virada da mÃºsica â€” de suave para explosivo â€” te surpreendeu com impacto, ou o fone nÃ£o conseguiu expressar bem essa transiÃ§Ã£o?"},
  {lv:5,ch:"Velocidade de resposta em alternÃ¢ncia tonal.",d:'Aqui viola e distorÃ§Ã£o pesada alternam em segundos. O fone precisa de velocidade para trocar de um extremo ao outro sem embaralhar os sons.',g:"Metal Progressivo",s:"Ghost of Perdition",a:"Opeth",sid:"3O9NfKF9byHvKVSHXqjqiI",fq:"mid",q:"Quando a mÃºsica mudava radicalmente de timbre em poucos segundos, o fone acompanhou sem embaralhar os sons?"},
  {lv:5,ch:"Vocal e bateria audÃ­veis sob camadas de guitarra.",d:'Camadas e mais camadas de guitarra. O desafio Ã© ouvir a bateria e o vocal claramente mesmo com tudo aquilo soando ao mesmo tempo.',g:"Metal Progressivo",s:"Blackest Eyes",a:"Porcupine Tree",sid:"0bsn6EsAuQ7n7OTorWZ0nb",fq:"mid",q:"Com todas as guitarras soando juntas, vocÃª ainda conseguiu ouvir a bateria e o vocal por baixo de tudo?"},
  {lv:5,ch:"Inteligibilidade vocal sobre beat denso.",d:'No meio de um beat pesado de rap, cada sÃ­laba do Mano Brown precisa chegar clara. Se a voz sumir no grave, o fone nÃ£o faz o dever de casa.',g:"Rap Brasileiro",s:"A Vida Ã‰ Desafio",a:"Racionais MC's",sid:"5Ww4TFkv3BkHEDrFmvIf0c",fq:"mid",q:"VocÃª conseguiu entender cada palavra do rap claramente, ou a voz se perdeu no meio do beat pesado?"},
  {lv:5,ch:"ExtensÃ£o de sub-bass: vocÃª sente a nota?",d:'Esse Ã© o teste final de sub-bass. A nota mais profunda da mÃºsica sÃ³ aparece para quem tem fone de verdade. VocÃª vai sentir ou vai perder?',g:"Rap Brasileiro",s:"777-666",a:"MatuÃª",sid:"6T88OcMHvRgIFObNHkwT0R",fq:"low",q:"VocÃª sentiu a nota grave mais funda da mÃºsica â€” aquela que parece vibrar no peito â€” ou ela sumiu no seu fone?"},
];

const LOCAL_FILES=[
  'audio/01_Get_Lucky.mp3','audio/02_Blinding_Lights.mp3','audio/03_Dont_Stop_Til_You_Get_Enough.mp3',
  'audio/04_Flowers.mp3','audio/05_No_Love_Dying.mp3','audio/06_Feeling_Good.mp3',
  'audio/07_Misery_Business.mp3','audio/08_telepatia.mp3','audio/09_Arranhao.mp3',
  'audio/10_Pe_Na_Areia.mp3','audio/11_Sinal_Vital.mp3','audio/12_Basket_Case.mp3',
  'audio/13_bad_guy.mp3','audio/14_MONACO.mp3','audio/15_Erro_Gostoso.mp3',
  'audio/16_Hi-Lo_Hollow.mp3','audio/17_Ghost_of_Perdition.mp3','audio/18_Blackest_Eyes.mp3',
  'audio/19_A_Vida_E_Desafio.mp3','audio/20_777-666.mp3',
];

/* â”€â”€â”€ AUDIO PLAYER (shared) â”€â”€â”€ */
const player = new Audio();
player.preload = 'none';

/* Contexto atual: 'exp' | 'playlist' | 'modal' */
let playerCtx = null;
let currentTrackIdx = -1;
let progressTimer = null;
let autoPlayEnabled = false;
let expObserver = null;

/* â”€â”€â”€ Player events â”€â”€â”€ */
player.addEventListener('playing', () => {
  if (playerCtx === 'exp') setExpPlayingUI(currentTrackIdx, true);
  if (playerCtx === 'playlist') setPlPlayingUI(currentTrackIdx, true);
  if (playerCtx === 'modal') setModalPlayingUI(true);
  startProgressTimer();
  showToast(`â–¶ ${T[currentTrackIdx].s} â€” ${T[currentTrackIdx].a}`, 4000);
});
player.addEventListener('pause', () => {
  if (playerCtx === 'exp') setExpPlayingUI(currentTrackIdx, false);
  if (playerCtx === 'playlist') setPlPlayingUI(currentTrackIdx, false);
  if (playerCtx === 'modal') setModalPlayingUI(false);
  stopProgressTimer();
});
player.addEventListener('ended', () => {
  if (playerCtx === 'exp') { setExpPlayingUI(currentTrackIdx, false); stopProgressTimer(); resetExpProgress(currentTrackIdx); }
  if (playerCtx === 'playlist') { plNext(); }
  if (playerCtx === 'modal') { setModalPlayingUI(false); stopProgressTimer(); resetModalProgress(); }
});
player.addEventListener('error', () => {
  showToast('âš  Arquivo nÃ£o encontrado â€” verifique a pasta audio/', 5000);
  if (playerCtx === 'exp') setExpPlayingUI(currentTrackIdx, false);
  if (playerCtx === 'playlist') setPlPlayingUI(currentTrackIdx, false);
  if (playerCtx === 'modal') setModalPlayingUI(false);
  stopProgressTimer();
});
player.addEventListener('waiting', () => {
  if (playerCtx === 'exp') { const b = document.getElementById(`pb${currentTrackIdx}`); if(b){b.classList.add('loading');b.innerHTML='â—‹';} }
  if (playerCtx === 'playlist') { const b = document.getElementById('pl-play-btn'); if(b){b.classList.add('loading');b.innerHTML='â—‹';} }
  if (playerCtx === 'modal') { const b = document.getElementById('modal-play-btn'); if(b){b.classList.add('loading');b.innerHTML='â—‹';} }
});

function playTrack(idx, ctx) {
  player.pause();
  currentTrackIdx = idx;
  playerCtx = ctx;
  player.src = LOCAL_FILES[idx];
  player.load();
  player.play().catch(() => showToast('âš  Toque em qualquer lugar para habilitar o Ã¡udio', 4000));
}

function stopAll() {
  player.pause();
  if (currentTrackIdx >= 0) {
    if (playerCtx === 'exp') setExpPlayingUI(currentTrackIdx, false);
    if (playerCtx === 'playlist') setPlPlayingUI(currentTrackIdx, false);
    if (playerCtx === 'modal') setModalPlayingUI(false);
    stopProgressTimer();
  }
  playerCtx = null;
}

/* â”€â”€â”€ Progress timer â”€â”€â”€ */
function startProgressTimer() {
  stopProgressTimer();
  progressTimer = setInterval(() => {
    try {
      const c = player.currentTime, d = player.duration || 0;
      if (!d) return;
      const pct = (c / d) * 100;
      const fmt = (s) => `${Math.floor(s/60)}:${Math.floor(s%60).toString().padStart(2,'0')}`;
      if (playerCtx === 'exp') {
        const f = document.getElementById(`af${currentTrackIdx}`);
        const p = document.getElementById(`p${currentTrackIdx}`);
        const tm = document.getElementById(`atm${currentTrackIdx}`);
        const du = document.getElementById(`adu${currentTrackIdx}`);
        if (f) f.style.width = pct + '%';
        if (p) p.style.width = pct + '%';
        if (tm) tm.textContent = fmt(c);
        if (du) du.textContent = fmt(d);
      }
      if (playerCtx === 'playlist') {
        const f = document.getElementById('pl-prog-fill');
        const tm = document.getElementById('pl-tm');
        const du = document.getElementById('pl-dur');
        if (f) f.style.width = pct + '%';
        if (tm) tm.textContent = fmt(c);
        if (du) du.textContent = fmt(d);
      }
      if (playerCtx === 'modal') {
        const f = document.getElementById('modal-fill');
        const tm = document.getElementById('modal-tm');
        const du = document.getElementById('modal-dur');
        if (f) f.style.width = pct + '%';
        if (tm) tm.textContent = fmt(c);
        if (du) du.textContent = fmt(d);
      }
    } catch(e) {}
  }, 500);
}
function stopProgressTimer() { if (progressTimer) { clearInterval(progressTimer); progressTimer = null; } }

/* â”€â”€â”€ NAVIGATION â”€â”€â”€ */
function nav(page) {
  /* Stop audio when switching away from exp/playlist/modal */
  if (page !== 'experience' && page !== 'playlist') {
    stopAll();
    autoPlayEnabled = false;
    rpHide();
  }
  if (page === 'experience') {
    /* Re-enable exp dots */
    document.getElementById('exp-sdots').classList.add('visible');
  } else {
    document.getElementById('exp-sdots').classList.remove('visible');
  }

  document.querySelectorAll('.page').forEach(p => { p.classList.remove('active'); p.scrollTop = 0; });
  document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
  document.getElementById('page-' + page).classList.add('active');
  document.querySelector(`[data-page="${page}"]`).classList.add('active');

  /* Scroll exp container to top when entering */
  if (page === 'experience') {
    const sc = document.getElementById('exp-scroll');
    if (sc) sc.scrollTop = 0;
  }
  /* Build playlist if needed */
  if (page === 'playlist') buildPlaylist();
}

/* â”€â”€â”€ CURSOR â”€â”€â”€ */
const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
const cur = document.getElementById('cur'), curR = document.getElementById('curR');
let cx=0, cy=0, rx=0, ry=0;
if (!isTouch) {
  document.addEventListener('mousemove', e => { cx=e.clientX; cy=e.clientY; cur.style.left=cx+'px'; cur.style.top=cy+'px'; });
  (function aR(){ rx+=(cx-rx)*.1; ry+=(cy-ry)*.1; curR.style.left=rx+'px'; curR.style.top=ry+'px'; requestAnimationFrame(aR); })();
}
function hov(on) { if(!isTouch){ cur.classList.toggle('h',on); curR.classList.toggle('h',on); } }

/* â”€â”€â”€ TOAST â”€â”€â”€ */
let toastTimer;
function showToast(msg, dur=3000) {
  const t = document.getElementById('toast');
  document.getElementById('toast-msg').textContent = msg;
  t.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer = setTimeout(() => t.classList.remove('show'), dur);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   HOME â€” build challenge cards
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function buildHome() {
  const body = document.getElementById('home-challenges-body');
  const byLevel = {};
  T.forEach((t,i) => { (byLevel[t.lv]||(byLevel[t.lv]=[])).push({...t,idx:i}); });
  [1,2,3,4,5].forEach(lv => {
    const group = byLevel[lv]||[];
    if (!group.length) return;
    const sec = document.createElement('div');
    sec.className = 'lvl-section';
    const pips = Array.from({length:5},(_,i)=>`<div class="lvl-pip-dot" style="${i<lv?'background:'+( GC[group[0].g]||'#1DB954')+'60':''}"></div>`).join('');
    sec.innerHTML=`<div class="lvl-header"><div class="lvl-badge"><span class="lvl-emoji">${LE[lv]}</span><span class="lvl-name-txt">NÃ­vel ${lv} â€” ${LL[lv]}</span></div><div class="lvl-pips-row">${pips}</div></div><div class="challenge-cards" id="cc${lv}"></div>`;
    body.appendChild(sec);
    const grid = sec.querySelector(`#cc${lv}`);
    group.forEach(t => {
      const c = GC[t.g]||'#1DB954';
      const card = document.createElement('div');
      card.className='ccard'; card.style.setProperty('--cc',c);
      card.innerHTML=`<div class="ccard-genre">${t.g}</div><div class="ccard-challenge">${t.ch}</div><div class="ccard-track"><strong>${t.s}</strong> Â· ${t.a}</div><div class="ccard-arrow"><svg viewBox="0 0 24 24" fill="none" stroke-width="2.5"><polyline points="9 18 15 12 9 6"/></svg></div>`;
      card.addEventListener('click', () => openModal(t.idx));
      if (!isTouch) { card.addEventListener('mouseenter',()=>hov(true)); card.addEventListener('mouseleave',()=>hov(false)); }
      grid.appendChild(card);
    });
  });
})();

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   MODAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let modalIdx = -1;

function openModal(idx) {
  modalIdx = idx;
  const t = T[idx];
  const c = GC[t.g]||'#1DB954';
  const box = document.getElementById('modal-box');
  box.style.setProperty('--tc', c);

  document.getElementById('modal-genre-badge').textContent = t.g;
  document.getElementById('modal-genre-badge').style.setProperty('--tc',c);
  document.getElementById('modal-ch-label').textContent = `${LE[t.lv]} ${LL[t.lv]} Â· NÃ­vel ${t.lv}`;
  document.getElementById('modal-ch-label').style.setProperty('--tc',c);
  document.getElementById('modal-title').textContent = t.s;
  document.getElementById('modal-artist').textContent = t.a;
  document.getElementById('modal-desc').textContent = t.d;
  document.getElementById('modal-sp-btn').href = `https://open.spotify.com/track/${t.sid}`;

  const pips = document.getElementById('modal-diff-pips');
  pips.innerHTML = Array.from({length:5},(_,i)=>`<div class="modal-diff-pip${i<t.lv?' on':''}"></div>`).join('');

  const wv = document.getElementById('modal-waveform');
  wv.innerHTML = Array.from({length:14},(_,wi)=>`<div class="modal-wb" style="height:${6+Math.random()*18}px;animation-delay:${wi*.07}s"></div>`).join('');

  const vinyl = document.getElementById('modal-vinyl');
  vinyl.style.setProperty('--tc',c);
  vinyl.classList.remove('playing');

  resetModalProgress();
  setModalPlayingUI(false);

  document.getElementById('modal-overlay').classList.add('open');
  document.body.style.overflow = 'hidden';

  /* If this track is already playing in exp/playlist, sync */
  if (currentTrackIdx === idx && !player.paused) {
    playerCtx = 'modal';
    setModalPlayingUI(true);
  }
}

function closeModal(e, force) {
  if (!force && e && e.target !== document.getElementById('modal-overlay')) return;
  document.getElementById('modal-overlay').classList.remove('open');
  document.body.style.overflow = '';
  if (playerCtx === 'modal') { player.pause(); playerCtx = null; }
}

function modalPlayClick() {
  autoPlayEnabled = true;
  if (playerCtx === 'modal' && currentTrackIdx === modalIdx) {
    if (!player.paused) player.pause(); else player.play().catch(()=>{});
  } else {
    playTrack(modalIdx, 'modal');
  }
}

function modalSeek(e) {
  if (!player.duration) return;
  const r = e.currentTarget.getBoundingClientRect();
  player.currentTime = ((e.clientX - r.left) / r.width) * player.duration;
}

function setModalPlayingUI(on) {
  const btn = document.getElementById('modal-play-btn');
  const vinyl = document.getElementById('modal-vinyl');
  const wv = document.getElementById('modal-waveform');
  if (btn) { btn.innerHTML = on?'â¸':'â–¶'; btn.classList.toggle('playing',on); btn.classList.remove('loading'); }
  if (vinyl) vinyl.classList.toggle('playing', on);
  if (wv) wv.classList.toggle('playing', on);
}

function resetModalProgress() {
  const f=document.getElementById('modal-fill'), tm=document.getElementById('modal-tm'), du=document.getElementById('modal-dur');
  if(f)f.style.width='0%'; if(tm)tm.textContent='0:00'; if(du)du.textContent='â€”';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   EXPERIENCE â€” build sections
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
(function buildExp() {
  /* Challenge grid (tela 3) */
  const grid = document.getElementById('exp-ch-grid');
  const byLevel = {};
  T.forEach((t,i)=>{ (byLevel[t.lv]||(byLevel[t.lv]=[])).push({...t,idx:i}); });
  [1,2,3,4,5].forEach(lv=>{
    const group = byLevel[lv]||[];
    const col = document.createElement('div'); col.className='exp-ch-col';
    const c = GC[group[0]?.g]||'#1DB954';
    const pips = Array.from({length:5},(_,i)=>`<div class="exp-ch-pip" style="${i<lv?'background:'+c+'70':''}"></div>`).join('');
    col.innerHTML=`<div class="exp-ch-col-header"><span class="exp-ch-lv-emoji">${LE[lv]}</span><span class="exp-ch-lv-name">NÃ­vel ${lv}</span><div class="exp-ch-pips">${pips}</div></div>`;
    group.forEach(t=>{
      const item = document.createElement('div');
      item.className='exp-ch-item'; item.style.setProperty('--cc', GC[t.g]||'#1DB954');
      item.textContent = t.ch;
      item.addEventListener('click',()=>expScrollToTrack(t.idx));
      col.appendChild(item);
    });
    grid.appendChild(col);
  });

  /* Track sections */
  const container = document.getElementById('exp-tracks');
  const dots = document.getElementById('exp-sdots');
  /* Dots for 3 intro screens + 20 tracks */
  const totalSections = 3 + T.length;
  for(let di=0; di<totalSections; di++){
    const d=document.createElement('div'); d.className='exp-sdot'+(di===0?' active':'');
    d.addEventListener('click',()=>expScrollToSection(di));
    dots.appendChild(d);
  }

  T.forEach((t,i)=>{
    const c=GC[t.g]||'#1DB954', g2=GG[t.g]||'#0a3a0a';
    const isLast = i===T.length-1;
    const wBars = Array.from({length:20},(_,wi)=>`<div class="wb" style="height:${8+Math.random()*28}px;animation-delay:${wi*.055}s"></div>`).join('');
    const dPips = Array.from({length:5},(_,pi)=>`<div class="d-pip${pi<t.lv?' on':''}"></div>`).join('');
    const sec = document.createElement('div');
    sec.className='exp-section exp-ts'; sec.id=`t${i}`; sec.dataset.i=i; sec.style.setProperty('--tc',c);
    const dPipsHTML = Array.from({length:5},(_,pi)=>`<div class="t-diff-pip${pi<t.lv?' on':''}"></div>`).join('');
    const nextHTML = !isLast ? `<div class="t-next-inline">PrÃ³xima <div class="t-next-arrow"></div></div>` : `<div style="display:flex;flex-direction:column;align-items:flex-end;gap:8px"><div style="font-size:.55rem;letter-spacing:2px;text-transform:uppercase;color:rgba(255,255,255,.15)">Fim âœ“</div><button onclick="rpShowReportBtn()" style="font-size:.6rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;padding:8px 16px;border-radius:999px;border:1px solid rgba(29,185,84,.4);background:rgba(29,185,84,.1);color:#1DB954;cursor:pointer;transition:all .2s" onmouseover="this.style.background='rgba(29,185,84,.22)'" onmouseout="this.style.background='rgba(29,185,84,.1)'">ðŸ“Š Ver relatÃ³rio</button></div>`;
    sec.innerHTML=`
      <div class="t-bg" style="background:radial-gradient(ellipse 55% 55% at 30% 55%,${c}35,transparent 55%),radial-gradient(ellipse 45% 45% at 70% 45%,${g2}28,transparent 55%),#07070f"></div>
      <div class="t-ov"></div>
      <div class="t-prog" id="p${i}"></div>
      <div class="t-nav">
        <span class="t-ctr">${String(i+1).padStart(2,'0')} / ${String(T.length).padStart(2,'0')}</span>
        <div class="t-nav-right">
          <span class="t-genre">${t.g}</span>
          <div class="t-diff-inline"><span>Dificuldade</span><div class="t-diff-pips">${dPipsHTML}</div></div>
          ${nextHTML}
        </div>
      </div>
      <div class="t-content">
        <div>
          <p class="challenge-label">${LE[t.lv]} ${LL[t.lv]} Â· NÃ­vel ${t.lv}</p>
          <h2 class="t-title">${t.s}</h2>
          <p class="t-artist">${t.a}</p>
          <p class="t-desc">${t.d}</p>
        </div>
        <div class="t-player">
          <div class="vinyl" id="v${i}"></div>
          <div class="waveform" id="w${i}">${wBars}</div>
          <div class="controls-row">
            <button class="play-btn" id="pb${i}" data-i="${i}">â–¶</button>
            <a class="sp-btn" href="https://open.spotify.com/track/${t.sid}" target="_blank" rel="noopener">
              <svg class="sp-ico" viewBox="0 0 24 24" fill="#1DB954"><path d="M12 0C5.4 0 0 5.4 0 12s5.4 12 12 12 12-5.4 12-12S18.66 0 12 0zm5.521 17.34c-.24.359-.66.48-1.021.24-2.82-1.74-6.36-2.101-10.561-1.141-.418.122-.779-.179-.899-.539-.12-.421.18-.78.54-.9 4.56-1.021 8.52-.6 11.64 1.32.42.18.479.659.301 1.02zm1.44-3.3c-.301.42-.841.6-1.262.3-3.239-1.98-8.159-2.58-11.939-1.38-.479.12-1.02-.12-1.14-.6-.12-.48.12-1.021.6-1.141C9.6 9.9 15 10.561 18.72 12.84c.361.181.54.78.241 1.2zm.12-3.36C15.24 8.4 8.82 8.16 5.16 9.301c-.6.179-1.2-.181-1.38-.721-.18-.601.18-1.2.72-1.381 4.26-1.26 11.28-1.02 15.721 1.621.539.3.719 1.02.419 1.56-.299.421-1.02.599-1.559.3z"/></svg>
              Spotify
            </a>
          </div>
          <div class="a-prog">
            <div class="a-track" id="at${i}"><div class="a-fill" id="af${i}"></div></div>
            <div class="a-times"><span id="atm${i}">0:00</span><span id="adu${i}">â€”</span></div>
          </div>
        </div>
      </div>`;
    container.appendChild(sec);

    /* Seek bar */
    sec.querySelector(`#at${i}`).addEventListener('click',e=>{
      if(player.duration && currentTrackIdx===i && playerCtx==='exp'){
        const r=e.currentTarget.getBoundingClientRect();
        player.currentTime=((e.clientX-r.left)/r.width)*player.duration;
      }
    });
    /* Play button */
    sec.querySelector(`#pb${i}`).addEventListener('click',()=>{
      autoPlayEnabled=true;
      if(playerCtx==='exp'&&currentTrackIdx===i){ if(!player.paused)player.pause(); else player.play().catch(()=>{}); }
      else { playTrack(i,'exp'); }
    });
  });

  /* IntersectionObserver for exp sections */
  const allExpSecs = [
    document.getElementById('exp-intro'),
    document.getElementById('exp-about'),
    document.getElementById('exp-challenges'),
    ...T.map((_,i)=>document.getElementById(`t${i}`))
  ];
  expObserver = new IntersectionObserver(entries=>{
    entries.forEach(entry=>{
      if(!entry.isIntersecting||entry.intersectionRatio<.6)return;
      const sec=entry.target;
      const di=allExpSecs.indexOf(sec);
      if(di>=0) updateExpDots(di);
      const i=parseInt(sec.dataset.i);
      if(isNaN(i))return;
      /* Stop exp music if leaving exp page â€” handled by nav() */
      if(autoPlayEnabled && playerCtx==='exp' && i!==currentTrackIdx) playTrack(i,'exp');
      else if(autoPlayEnabled && playerCtx===null && i!==currentTrackIdx) playTrack(i,'exp');
      /* Trigger rating panel */
      rpTriggerForTrack(i);
    });
  },{threshold:.6,root:document.getElementById('exp-scroll')});
  allExpSecs.forEach(s=>{ if(s) expObserver.observe(s); });
})();

function updateExpDots(idx) {
  document.querySelectorAll('.exp-sdot').forEach((d,i)=>d.classList.toggle('active',i===idx));
}
function expScrollToSection(idx) {
  const allSecs=[
    document.getElementById('exp-intro'),document.getElementById('exp-about'),document.getElementById('exp-challenges'),
    ...T.map((_,i)=>document.getElementById(`t${i}`))
  ];
  const target=allSecs[Math.max(0,Math.min(allSecs.length-1,idx))];
  if(target){ const sc=document.getElementById('exp-scroll'); sc.scrollTo({top:target.offsetTop,behavior:'smooth'}); }
}
function expScrollToTrack(idx){ autoPlayEnabled=true; expScrollToSection(idx+3); }
function expGoToAbout(){
  const sc=document.getElementById('exp-scroll');
  const ab=document.getElementById('exp-about');
  if(sc&&ab) sc.scrollTo({top:ab.offsetTop,behavior:'smooth'});
}

function setExpPlayingUI(idx,on){
  if(idx<0)return;
  const btn=document.getElementById(`pb${idx}`),v=document.getElementById(`v${idx}`),w=document.getElementById(`w${idx}`);
  if(btn){btn.innerHTML=on?'â¸':'â–¶';btn.classList.toggle('playing',on);btn.classList.remove('loading');}
  if(v)v.classList.toggle('playing',on);
  if(w)w.classList.toggle('playing',on);
}
function resetExpProgress(idx){
  const f=document.getElementById(`af${idx}`),p=document.getElementById(`p${idx}`),t=document.getElementById(`atm${idx}`);
  if(f)f.style.width='0%';if(p)p.style.width='0%';if(t)t.textContent='0:00';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   PLAYLIST â€” build & controls
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
let plBuilt = false;
function buildPlaylist(){
  if(plBuilt)return; plBuilt=true;
  const list=document.getElementById('pl-track-list');
  T.forEach((t,i)=>{
    const c=GC[t.g]||'#1DB954';
    const pips=Array.from({length:5},(_,pi)=>`<div class="pl-tr-pip" style="${pi<t.lv?'background:'+c+'70':''}"></div>`).join('');
    const row=document.createElement('div');
    row.className='pl-track-row'; row.id=`plr${i}`;
    row.innerHTML=`<span class="pl-tr-num">${String(i+1).padStart(2,'0')}</span><span class="pl-tr-icon">â–¶</span><div class="pl-tr-info"><div class="pl-tr-name">${t.s}</div><div class="pl-tr-artist">${t.a}</div></div><span class="pl-tr-genre" style="border-color:${c}30;color:${c}80">${t.g}</span><div class="pl-tr-lv">${pips}</div>`;
    row.addEventListener('click',()=>plPlay(i));
    list.appendChild(row);
  });
}

function plPlay(idx){
  autoPlayEnabled=true;
  /* If already playing this track in playlist, toggle */
  if(playerCtx==='playlist'&&currentTrackIdx===idx){ if(!player.paused)player.pause(); else player.play().catch(()=>{}); return; }
  /* Clear previous active */
  document.querySelectorAll('.pl-track-row').forEach(r=>r.classList.remove('active'));
  const row=document.getElementById(`plr${idx}`);
  if(row)row.classList.add('active');
  /* Update now playing bar */
  document.getElementById('pl-np-track').textContent=T[idx].s;
  document.getElementById('pl-np-artist').textContent=T[idx].a;
  playTrack(idx,'playlist');
}

function plPlayPause(){
  autoPlayEnabled=true;
  if(playerCtx==='playlist'&&currentTrackIdx>=0){
    if(!player.paused)player.pause(); else player.play().catch(()=>{});
  } else if(currentTrackIdx>=0){
    plPlay(currentTrackIdx);
  } else {
    plPlay(0);
  }
}
function plNext(){ plPlay((currentTrackIdx+1)%T.length); }
function plPrev(){ plPlay((currentTrackIdx-1+T.length)%T.length); }
function plSeek(e){
  if(!player.duration)return;
  const r=e.currentTarget.getBoundingClientRect();
  player.currentTime=((e.clientX-r.left)/r.width)*player.duration;
}

function setPlPlayingUI(idx,on){
  const btn=document.getElementById('pl-play-btn');
  if(btn){btn.innerHTML=on?'â¸':'â–¶';btn.classList.toggle('active-play',on);btn.classList.remove('loading');}
  if(!on) return;
  /* Update now playing */
  document.getElementById('pl-np-track').textContent=T[idx].s;
  document.getElementById('pl-np-artist').textContent=T[idx].a;
}


/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RATING SYSTEM
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const ratings = new Array(T.length).fill(null); // null=not rated, false=skipped, 0â€“5=score
let rpCurrentIdx = -1;
let rpHover = null;

function rpShow(idx) {
  if (idx < 0 || idx >= T.length) return;
  rpCurrentIdx = idx;
  const t = T[idx];
  const c = GC[t.g] || '#1DB954';
  const panel = document.getElementById('rating-panel');

  panel.style.setProperty('--rpc', c);
  document.getElementById('rp-track-name').textContent = t.s + ' Â· ' + t.a;
  document.getElementById('rp-question').textContent = t.q;
  document.getElementById('rp-value').textContent = '';
  document.getElementById('rp-btn-rate').classList.remove('ready');
  rpHover = null;

  // Build stars
  const starsEl = document.getElementById('rp-stars');
  starsEl.innerHTML = '';
  for (let s = 1; s <= 5; s++) {
    const star = document.createElement('span');
    star.className = 'rp-star';
    star.textContent = 'â˜…';
    star.dataset.val = s;
    star.addEventListener('mousemove', e => rpStarHover(e, s, star));
    star.addEventListener('mouseleave', () => rpStarLeave());
    star.addEventListener('click', e => rpStarClick(e, s, star));
    starsEl.appendChild(star);
  }

  // Progress dots
  rpUpdateProgress();
  panel.classList.add('visible');
}

function rpHide() {
  document.getElementById('rating-panel').classList.remove('visible');
  rpCurrentIdx = -1;
}

function rpStarHover(e, s, el) {
  const rect = el.getBoundingClientRect();
  const isLeft = (e.clientX - rect.left) < rect.width / 2;
  rpHover = isLeft ? s - 0.5 : s;
  rpRenderStars(rpHover);
  const valEl = document.getElementById('rp-value');
  valEl.textContent = rpHover === 1 ? '1 estrela' : rpHover + ' estrelas';
  document.getElementById('rp-btn-rate').classList.add('ready');
}

function rpStarLeave() {
  const selected = ratings[rpCurrentIdx];
  if (typeof selected === 'number') {
    rpRenderStars(selected);
    document.getElementById('rp-value').textContent = selected === 1 ? '1 estrela' : selected + ' estrelas';
  } else {
    rpRenderStars(0);
    document.getElementById('rp-value').textContent = '';
    if (selected === null) document.getElementById('rp-btn-rate').classList.remove('ready');
  }
  rpHover = null;
}

function rpStarClick(e, s, el) {
  const rect = el.getBoundingClientRect();
  const isLeft = (e.clientX - rect.left) < rect.width / 2;
  const val = isLeft ? s - 0.5 : s;
  ratings[rpCurrentIdx] = val;
  rpRenderStars(val);
  document.getElementById('rp-value').textContent = val === 1 ? '1 estrela' : val + ' estrelas';
  document.getElementById('rp-btn-rate').classList.add('ready');
  rpUpdateProgress();
}

function rpRenderStars(val) {
  document.querySelectorAll('.rp-star').forEach((star, i) => {
    const starNum = i + 1;
    star.classList.remove('full', 'half');
    if (val >= starNum) star.classList.add('full');
    else if (val >= starNum - 0.5) star.classList.add('half');
  });
}

function rpUpdateProgress() {
  const prog = document.getElementById('rp-progress');
  prog.innerHTML = '';
  T.forEach((_, i) => {
    const dot = document.createElement('div');
    dot.className = 'rp-pdot';
    if (ratings[i] === false) dot.classList.add('skipped');
    else if (typeof ratings[i] === 'number') dot.classList.add('rated');
    else if (i === rpCurrentIdx) dot.classList.add('current');
    prog.appendChild(dot);
  });
}

function rpSkip() {
  if (rpCurrentIdx >= 0) ratings[rpCurrentIdx] = false;
  rpHide();
  // Check if last track and show report prompt
  rpCheckShowReportButton();
}

function rpConfirm() {
  if (rpCurrentIdx < 0) return;
  if (typeof ratings[rpCurrentIdx] !== 'number') return;
  rpHide();
  rpCheckShowReportButton();
  showToast('â­ AvaliaÃ§Ã£o registrada!', 2000);
}

function rpCheckShowReportButton() {
  const allDone = ratings.every(r => r !== null);
  if (allDone) {
    setTimeout(() => showReport(), 600);
  }
}

// Called by IntersectionObserver when a track comes into view
function rpTriggerForTrack(idx) {
  // Only show if on experience page and not already rated/skipped
  const page = document.getElementById('page-experience');
  if (!page.classList.contains('active')) return;
  if (ratings[idx] !== null) return; // already rated or skipped
  // Small delay so the music starts first
  setTimeout(() => {
    if (rpCurrentIdx !== idx) rpShow(idx);
  }, 1800);
}

/* â”€â”€ Report generation â”€â”€ */
function showReport() {
  const ratedEntries = T.map((t, i) => ({ t, i, r: ratings[i] })).filter(e => typeof e.r === 'number');

  if (ratedEntries.length === 0) {
    showToast('Avalie pelo menos uma mÃºsica para ver o relatÃ³rio!', 4000);
    return;
  }

  // Check minimum coverage
  const hasLow  = ratedEntries.some(e => e.t.fq === 'low');
  const hasMid  = ratedEntries.some(e => e.t.fq === 'mid');
  const hasHigh = ratedEntries.some(e => e.t.fq === 'high');
  const insufficient = !hasLow || !hasMid || !hasHigh;

  // Category averages
  function catAvg(fq) {
    const entries = ratedEntries.filter(e => e.t.fq === fq);
    if (!entries.length) return null;
    return entries.reduce((s, e) => s + e.r, 0) / entries.length;
  }
  const avgLow  = catAvg('low');
  const avgMid  = catAvg('mid');
  const avgHigh = catAvg('high');

  // Overall avg
  const overallAvg = ratedEntries.reduce((s, e) => s + e.r, 0) / ratedEntries.length;
  const overallRound = Math.round(overallAvg * 2) / 2;

  // Title / subtitle
  let title = 'RelatÃ³rio do Fone';
  let subtitle = '';
  if (insufficient) {
    subtitle = 'AvaliaÃ§Ã£o incompleta â€” faltaram categorias de frequÃªncia.';
  } else if (overallAvg >= 4.5) {
    subtitle = 'Seu fone Ã© excepcional. ParabÃ©ns pela escolha!';
  } else if (overallAvg >= 3.5) {
    subtitle = 'Seu fone performa bem acima da mÃ©dia.';
  } else if (overallAvg >= 2.5) {
    subtitle = 'Seu fone Ã© competente, com algumas limitaÃ§Ãµes.';
  } else if (overallAvg >= 1.5) {
    subtitle = 'Seu fone tem limitaÃ§Ãµes perceptÃ­veis na reproduÃ§Ã£o.';
  } else {
    subtitle = 'Seu fone apresenta limitaÃ§Ãµes significativas.';
  }

  document.getElementById('rep-title').textContent = title;
  document.getElementById('rep-subtitle').textContent = subtitle;
  document.getElementById('rep-rated-count').textContent = ratedEntries.length;

  // Big stars
  const bigStars = document.getElementById('rep-big-stars');
  bigStars.innerHTML = renderStarHTML(overallRound, 'report-big-star');
  document.getElementById('rep-score-num').textContent = insufficient ? 'â€”' : overallRound.toFixed(1);

  // Category cards
  const cats = [
    { fq:'low',  icon:'ðŸ”Š', name:'Graves', avg:avgLow  },
    { fq:'mid',  icon:'ðŸŽµ', name:'MÃ©dios', avg:avgMid  },
    { fq:'high', icon:'âœ¨', name:'Agudos', avg:avgHigh },
  ];
  const catsEl = document.getElementById('rep-cats');
  catsEl.innerHTML = '';
  cats.forEach(cat => {
    const div = document.createElement('div');
    div.className = 'report-cat' + (cat.avg === null ? ' insufficient' : '');
    const val = cat.avg !== null ? (Math.round(cat.avg * 2) / 2) : null;
    div.innerHTML = `
      <div class="report-cat-icon">${cat.icon}</div>
      <div class="report-cat-name">${cat.name}</div>
      <div class="report-cat-stars">${cat.avg !== null ? renderStarHTML(val, 'report-cat-star') : '<span style="font-size:.65rem;color:rgba(255,100,100,.5)">nÃ£o avaliado</span>'}</div>
      <div class="report-cat-val">${cat.avg !== null ? val.toFixed(1) + ' / 5' : 'â€”'}</div>`;
    catsEl.appendChild(div);
  });

  // Insights
  const insightsEl = document.getElementById('rep-insights');
  insightsEl.innerHTML = '';
  const insights = [];

  if (insufficient) {
    insights.push({ icon:'âš ï¸', text:'<strong>AvaliaÃ§Ã£o insuficiente.</strong> Para um relatÃ³rio completo, Ã© preciso avaliar pelo menos uma mÃºsica de graves, uma de mÃ©dios e uma de agudos.' });
  } else {
    // Strengths
    const strong = cats.filter(c => c.avg !== null && c.avg >= 3.8).map(c => c.name);
    const weak   = cats.filter(c => c.avg !== null && c.avg < 2.5).map(c => c.name);
    if (strong.length) insights.push({ icon:'âœ…', text:`<strong>Ponto forte:</strong> Seu fone se destaca na reproduÃ§Ã£o de <strong>${strong.join(' e ')}</strong>. Ã“tima performance nessa faixa.` });
    if (weak.length)   insights.push({ icon:'âš ï¸', text:`<strong>LimitaÃ§Ã£o:</strong> O fone apresenta dificuldade com <strong>${weak.join(' e ')}</strong>. Isso Ã© comum em fones de entrada ou com resposta de frequÃªncia limitada.` });

    // Specific insights by category avg
    if (avgLow !== null && avgHigh !== null) {
      const diff = avgHigh - avgLow;
      if (diff > 1.5)       insights.push({ icon:'ðŸ’¡', text:'Seu fone tende a ser <strong>brilhante e analÃ­tico</strong> â€” acentuado nos agudos e mais contido nos graves. Ideal para podcasts e mÃºsicas acÃºsticas.' });
      else if (diff < -1.5) insights.push({ icon:'ðŸ’¡', text:'Seu fone tem um som <strong>escuro e encorpado</strong> â€” forte nos graves e mais discreto nos agudos. Ã“timo para rap, eletrÃ´nica e rock pesado.' });
      else                  insights.push({ icon:'ðŸ’¡', text:'Seu fone apresenta uma resposta de frequÃªncia <strong>relativamente equilibrada</strong> entre graves, mÃ©dios e agudos.' });
    }
    if (avgMid !== null && avgMid >= 4)   insights.push({ icon:'ðŸŽ¤', text:'<strong>Excelente separaÃ§Ã£o de mÃ©dios</strong> â€” seu fone reproduz vozes e instrumentos com boa presenÃ§a e clareza.' });
    if (overallAvg >= 4) insights.push({ icon:'ðŸŽ§', text:'No geral, seu fone tem <strong>desempenho audiÃ³filo</strong>. VocÃª estÃ¡ ouvindo mÃºsica como ela foi feita para ser ouvida.' });
    else if (overallAvg < 2) insights.push({ icon:'ðŸ”„', text:'Um upgrade de fone pode <strong>transformar completamente</strong> sua experiÃªncia musical. Mesmo modelos intermediÃ¡rios fariam grande diferenÃ§a.' });
  }

  insights.forEach(ins => {
    const div = document.createElement('div');
    div.className = 'report-insight';
    div.innerHTML = `<span class="report-insight-icon">${ins.icon}</span><span class="report-insight-text">${ins.text}</span>`;
    insightsEl.appendChild(div);
  });

  document.getElementById('report-overlay').classList.add('open');
}

function renderStarHTML(val, cls) {
  let html = '';
  for (let s = 1; s <= 5; s++) {
    let state = 'empty';
    if (val >= s) state = 'full';
    else if (val >= s - 0.5) state = 'half';
    html += `<span class="${cls} ${state}">â˜…</span>`;
  }
  return html;
}

function closeReport() {
  document.getElementById('report-overlay').classList.remove('open');
}

// Show report button at end of experience
function rpShowReportBtn() {
  const ratedCount = ratings.filter(r => typeof r === 'number').length;
  if (ratedCount > 0) showReport();
  else showToast('Avalie pelo menos uma mÃºsica para ver o relatÃ³rio!', 4000);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   FEEDBACK â€” send via EmailJS
   ConfiguraÃ§Ã£o: emailjs.com (gratuito, 200 emails/mÃªs)
   1. Crie conta em emailjs.com
   2. Add Email Service â†’ conecte seu Outlook
   3. Create Template com variÃ¡vel {{message}} e To: samu.lls@outlook.com
   4. Substitua as 3 constantes abaixo com seus IDs
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const EMAILJS_SERVICE_ID  = 'service_ur8j178';
const EMAILJS_TEMPLATE_ID = 'template_z66fcrn';

async function sendFeedback() {
  const textarea = document.getElementById('ap-fb-text');
  const btn      = document.getElementById('ap-fb-send');
  const success  = document.getElementById('ap-fb-success');
  const msg      = textarea.value.trim();

  if (!msg) { showToast('âœ Escreva algo antes de enviar!', 3000); return; }

  btn.disabled = true;
  btn.textContent = 'â€¦';

  /* Verifica se EmailJS foi configurado */
  if (EMAILJS_SERVICE_ID.startsWith('EMAILJS')) {
    /* Fallback: abre cliente de email do usuÃ¡rio */
    window.location.href =
      `mailto:samu.lls@outlook.com?subject=Hertz%20Hunt%20%E2%80%94%20Sugest%C3%A3o&body=${encodeURIComponent(msg)}`;
    textarea.value = '';
    success.classList.add('show');
    btn.disabled = false;
    btn.textContent = 'âœ‰ Enviar';
    return;
  }

  try {
    await emailjs.send(EMAILJS_SERVICE_ID, EMAILJS_TEMPLATE_ID, {
      message:  msg,
      to_email: 'samu.lls@outlook.com',
    });
    textarea.value = '';
    success.classList.add('show');
    showToast('âœ“ Feedback enviado!', 4000);
  } catch(e) {
    showToast('âš  Erro ao enviar. Tente de novo.', 4000);
    console.error('EmailJS error:', e);
  } finally {
    btn.disabled = false;
    btn.textContent = 'âœ‰ Enviar';
  }
}

['click','touchstart','keydown'].forEach(ev=>{
  document.addEventListener(ev,()=>{autoPlayEnabled=true;},{once:true,passive:true});
});
</script>
</body>
</html>
